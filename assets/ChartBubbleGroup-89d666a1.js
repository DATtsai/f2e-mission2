import{r as at,l as K,m as Or,q as Ur,s as qn,j as Wr,o as pe,c as me,t as Vr,d as Ht,u as Ei,a as Kn,b as qr,w as je,v as Zn,i as Qn}from"./index-d94e30f7.js";function Yi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Kr(t){return t.length===1&&(t=Zr(t)),{left:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var a=i+r>>>1;t(e[a],n)<0?i=a+1:r=a}return i},right:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var a=i+r>>>1;t(e[a],n)>0?r=a:i=a+1}return i}}}function Zr(t){return function(e,n){return Yi(t(e),n)}}var Bi=Kr(Yi),Hi=Bi.right,Xu=Bi.left;function Qr(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}var fn=Math.sqrt(50),dn=Math.sqrt(10),gn=Math.sqrt(2);function Jr(t,e,n){var i,r=-1,a,s,o;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((i=e<t)&&(a=t,t=e,e=a),(o=he(t,e,n))===0||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),s=new Array(a=Math.ceil(e-t+1));++r<a;)s[r]=(t+r)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),s=new Array(a=Math.ceil(t-e+1));++r<a;)s[r]=(t-r)/o;return i&&s.reverse(),s}function he(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=fn?10:a>=dn?5:a>=gn?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=fn?10:a>=dn?5:a>=gn?2:1)}function jr(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=fn?r*=10:a>=dn?r*=5:a>=gn&&(r*=2),e<t?-r:r}var tn=Array.prototype.slice;function ta(t){return t}var ue=1,ce=2,pn=3,$t=4,Jn=1e-6;function ea(t){return"translate("+(t+.5)+",0)"}function na(t){return"translate(0,"+(t+.5)+")"}function ia(t){return function(e){return+t(e)}}function ra(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function aa(){return!this.__axis}function Ye(t,e){var n=[],i=null,r=null,a=6,s=6,o=3,l=t===ue||t===$t?-1:1,h=t===$t||t===ce?"x":"y",f=t===ue||t===pn?ea:na;function c(u){var g=i??(e.ticks?e.ticks.apply(e,n):e.domain()),d=r??(e.tickFormat?e.tickFormat.apply(e,n):ta),p=Math.max(a,0)+o,m=e.range(),y=+m[0]+.5,b=+m[m.length-1]+.5,v=(e.bandwidth?ra:ia)(e.copy()),x=u.selection?u.selection():u,M=x.selectAll(".domain").data([null]),k=x.selectAll(".tick").data(g,e).order(),S=k.exit(),R=k.enter().append("g").attr("class","tick"),L=k.select("line"),C=k.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(R),L=L.merge(R.append("line").attr("stroke","currentColor").attr(h+"2",l*a)),C=C.merge(R.append("text").attr("fill","currentColor").attr(h,l*p).attr("dy",t===ue?"0em":t===pn?"0.71em":"0.32em")),u!==x&&(M=M.transition(u),k=k.transition(u),L=L.transition(u),C=C.transition(u),S=S.transition(u).attr("opacity",Jn).attr("transform",function(A){return isFinite(A=v(A))?f(A):this.getAttribute("transform")}),R.attr("opacity",Jn).attr("transform",function(A){var w=this.parentNode.__axis;return f(w&&isFinite(w=w(A))?w:v(A))})),S.remove(),M.attr("d",t===$t||t==ce?s?"M"+l*s+","+y+"H0.5V"+b+"H"+l*s:"M0.5,"+y+"V"+b:s?"M"+y+","+l*s+"V0.5H"+b+"V"+l*s:"M"+y+",0.5H"+b),k.attr("opacity",1).attr("transform",function(A){return f(v(A))}),L.attr(h+"2",l*a),C.attr(h,l*p).text(d),x.filter(aa).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===ce?"start":t===$t?"end":"middle"),x.each(function(){this.__axis=v})}return c.scale=function(u){return arguments.length?(e=u,c):e},c.ticks=function(){return n=tn.call(arguments),c},c.tickArguments=function(u){return arguments.length?(n=u==null?[]:tn.call(u),c):n.slice()},c.tickValues=function(u){return arguments.length?(i=u==null?null:tn.call(u),c):i&&i.slice()},c.tickFormat=function(u){return arguments.length?(r=u,c):r},c.tickSize=function(u){return arguments.length?(a=s=+u,c):a},c.tickSizeInner=function(u){return arguments.length?(a=+u,c):a},c.tickSizeOuter=function(u){return arguments.length?(s=+u,c):s},c.tickPadding=function(u){return arguments.length?(o=+u,c):o},c}function zu(t){return Ye(ue,t)}function Fu(t){return Ye(ce,t)}function sa(t){return Ye(pn,t)}function oa(t){return Ye($t,t)}var la={value:function(){}};function Be(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new fe(n)}function fe(t){this._=t}function ha(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}fe.prototype=Be.prototype={constructor:fe,on:function(t,e){var n=this._,i=ha(t+"",n),r,a=-1,s=i.length;if(arguments.length<2){for(;++a<s;)if((r=(t=i[a]).type)&&(r=ua(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)n[r]=jn(n[r],t.name,e);else if(e==null)for(r in n)n[r]=jn(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new fe(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,a;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],i=0,r=a.length;i<r;++i)a[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};function ua(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function jn(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=la,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var mn="http://www.w3.org/1999/xhtml";const ti={svg:"http://www.w3.org/2000/svg",xhtml:mn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function He(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ti.hasOwnProperty(e)?{space:ti[e],local:t}:t}function ca(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===mn&&e.documentElement.namespaceURI===mn?e.createElement(t):e.createElementNS(n,t)}}function fa(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function $i(t){var e=He(t);return(e.local?fa:ca)(e)}function da(){}function Sn(t){return t==null?da:function(){return this.querySelector(t)}}function ga(t){typeof t!="function"&&(t=Sn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,o=i[r]=new Array(s),l,h,f=0;f<s;++f)(l=a[f])&&(h=t.call(l,l.__data__,f,a))&&("__data__"in l&&(h.__data__=l.__data__),o[f]=h);return new W(i,this._parents)}function pa(){return[]}function Xi(t){return t==null?pa:function(){return this.querySelectorAll(t)}}function ma(t){typeof t!="function"&&(t=Xi(t));for(var e=this._groups,n=e.length,i=[],r=[],a=0;a<n;++a)for(var s=e[a],o=s.length,l,h=0;h<o;++h)(l=s[h])&&(i.push(t.call(l,l.__data__,h,s)),r.push(l));return new W(i,r)}function zi(t){return function(){return this.matches(t)}}function ya(t){typeof t!="function"&&(t=zi(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,o=i[r]=[],l,h=0;h<s;++h)(l=a[h])&&t.call(l,l.__data__,h,a)&&o.push(l);return new W(i,this._parents)}function Fi(t){return new Array(t.length)}function va(){return new W(this._enter||this._groups.map(Fi),this._parents)}function ye(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ye.prototype={constructor:ye,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function xa(t){return function(){return t}}var ei="$";function ba(t,e,n,i,r,a){for(var s=0,o,l=e.length,h=a.length;s<h;++s)(o=e[s])?(o.__data__=a[s],i[s]=o):n[s]=new ye(t,a[s]);for(;s<l;++s)(o=e[s])&&(r[s]=o)}function _a(t,e,n,i,r,a,s){var o,l,h={},f=e.length,c=a.length,u=new Array(f),g;for(o=0;o<f;++o)(l=e[o])&&(u[o]=g=ei+s.call(l,l.__data__,o,e),g in h?r[o]=l:h[g]=l);for(o=0;o<c;++o)g=ei+s.call(t,a[o],o,a),(l=h[g])?(i[o]=l,l.__data__=a[o],h[g]=null):n[o]=new ye(t,a[o]);for(o=0;o<f;++o)(l=e[o])&&h[u[o]]===l&&(r[o]=l)}function wa(t,e){if(!t)return g=new Array(this.size()),h=-1,this.each(function(k){g[++h]=k}),g;var n=e?_a:ba,i=this._parents,r=this._groups;typeof t!="function"&&(t=xa(t));for(var a=r.length,s=new Array(a),o=new Array(a),l=new Array(a),h=0;h<a;++h){var f=i[h],c=r[h],u=c.length,g=t.call(f,f&&f.__data__,h,i),d=g.length,p=o[h]=new Array(d),m=s[h]=new Array(d),y=l[h]=new Array(u);n(f,c,p,m,y,g,e);for(var b=0,v=0,x,M;b<d;++b)if(x=p[b]){for(b>=v&&(v=b+1);!(M=m[v])&&++v<d;);x._next=M||null}}return s=new W(s,i),s._enter=o,s._exit=l,s}function Aa(){return new W(this._exit||this._groups.map(Fi),this._parents)}function Ma(t,e,n){var i=this.enter(),r=this,a=this.exit();return i=typeof t=="function"?t(i):i.append(t+""),e!=null&&(r=e(r)),n==null?a.remove():n(a),i&&r?i.merge(r).order():r}function ka(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),s=new Array(i),o=0;o<a;++o)for(var l=e[o],h=n[o],f=l.length,c=s[o]=new Array(f),u,g=0;g<f;++g)(u=l[g]||h[g])&&(c[g]=u);for(;o<i;++o)s[o]=e[o];return new W(s,this._parents)}function La(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,a=i[r],s;--r>=0;)(s=i[r])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Da(t){t||(t=Sa);function e(c,u){return c&&u?t(c.__data__,u.__data__):!c-!u}for(var n=this._groups,i=n.length,r=new Array(i),a=0;a<i;++a){for(var s=n[a],o=s.length,l=r[a]=new Array(o),h,f=0;f<o;++f)(h=s[f])&&(l[f]=h);l.sort(e)}return new W(r,this._parents).order()}function Sa(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ca(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ra(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function Ta(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var s=i[r];if(s)return s}return null}function Ia(){var t=0;return this.each(function(){++t}),t}function Pa(){return!this.node()}function Na(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],a=0,s=r.length,o;a<s;++a)(o=r[a])&&t.call(o,o.__data__,a,r);return this}function Ea(t){return function(){this.removeAttribute(t)}}function Ya(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ba(t,e){return function(){this.setAttribute(t,e)}}function Ha(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function $a(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Xa(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function za(t,e){var n=He(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?Ya:Ea:typeof e=="function"?n.local?Xa:$a:n.local?Ha:Ba)(n,e))}function Gi(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Fa(t){return function(){this.style.removeProperty(t)}}function Ga(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Oa(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Ua(t,e,n){return arguments.length>1?this.each((e==null?Fa:typeof e=="function"?Oa:Ga)(t,e,n??"")):Mt(this.node(),t)}function Mt(t,e){return t.style.getPropertyValue(e)||Gi(t).getComputedStyle(t,null).getPropertyValue(e)}function Wa(t){return function(){delete this[t]}}function Va(t,e){return function(){this[t]=e}}function qa(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Ka(t,e){return arguments.length>1?this.each((e==null?Wa:typeof e=="function"?qa:Va)(t,e)):this.node()[t]}function Oi(t){return t.trim().split(/^|\s+/)}function Cn(t){return t.classList||new Ui(t)}function Ui(t){this._node=t,this._names=Oi(t.getAttribute("class")||"")}Ui.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Wi(t,e){for(var n=Cn(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Vi(t,e){for(var n=Cn(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Za(t){return function(){Wi(this,t)}}function Qa(t){return function(){Vi(this,t)}}function Ja(t,e){return function(){(e.apply(this,arguments)?Wi:Vi)(this,t)}}function ja(t,e){var n=Oi(t+"");if(arguments.length<2){for(var i=Cn(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Ja:e?Za:Qa)(n,e))}function ts(){this.textContent=""}function es(t){return function(){this.textContent=t}}function ns(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function is(t){return arguments.length?this.each(t==null?ts:(typeof t=="function"?ns:es)(t)):this.node().textContent}function rs(){this.innerHTML=""}function as(t){return function(){this.innerHTML=t}}function ss(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function os(t){return arguments.length?this.each(t==null?rs:(typeof t=="function"?ss:as)(t)):this.node().innerHTML}function ls(){this.nextSibling&&this.parentNode.appendChild(this)}function hs(){return this.each(ls)}function us(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cs(){return this.each(us)}function fs(t){var e=typeof t=="function"?t:$i(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ds(){return null}function gs(t,e){var n=typeof t=="function"?t:$i(t),i=e==null?ds:typeof e=="function"?e:Sn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function ps(){var t=this.parentNode;t&&t.removeChild(this)}function ms(){return this.each(ps)}function ys(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vs(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function xs(t){return this.select(t?vs:ys)}function bs(t){return arguments.length?this.property("__data__",t):this.node().__data__}var qi={},_=null;if(typeof document<"u"){var _s=document.documentElement;"onmouseenter"in _s||(qi={mouseenter:"mouseover",mouseleave:"mouseout"})}function ws(t,e,n){return t=Ki(t,e,n),function(i){var r=i.relatedTarget;(!r||r!==this&&!(r.compareDocumentPosition(this)&8))&&t.call(this,i)}}function Ki(t,e,n){return function(i){var r=_;_=i;try{t.call(this,this.__data__,e,n)}finally{_=r}}}function As(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Ms(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,a;n<r;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.capture):e[++i]=a;++i?e.length=i:delete this.__on}}}function ks(t,e,n){var i=qi.hasOwnProperty(t.type)?ws:Ki;return function(r,a,s){var o=this.__on,l,h=i(e,a,s);if(o){for(var f=0,c=o.length;f<c;++f)if((l=o[f]).type===t.type&&l.name===t.name){this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=h,l.capture=n),l.value=e;return}}this.addEventListener(t.type,h,n),l={type:t.type,name:t.name,value:e,listener:h,capture:n},o?o.push(l):this.__on=[l]}}function Ls(t,e,n){var i=As(t+""),r,a=i.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,h=o.length,f;l<h;++l)for(r=0,f=o[l];r<a;++r)if((s=i[r]).type===f.type&&s.name===f.name)return f.value}return}for(o=e?ks:Ms,n==null&&(n=!1),r=0;r<a;++r)this.each(o(i[r],e,n));return this}function ni(t,e,n,i){var r=_;t.sourceEvent=_,_=t;try{return e.apply(n,i)}finally{_=r}}function Zi(t,e,n){var i=Gi(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Ds(t,e){return function(){return Zi(this,t,e)}}function Ss(t,e){return function(){return Zi(this,t,e.apply(this,arguments))}}function Cs(t,e){return this.each((typeof e=="function"?Ss:Ds)(t,e))}var Qi=[null];function W(t,e){this._groups=t,this._parents=e}function St(){return new W([[document.documentElement]],Qi)}W.prototype=St.prototype={constructor:W,select:ga,selectAll:ma,filter:ya,data:wa,enter:va,exit:Aa,join:Ma,merge:ka,order:La,sort:Da,call:Ca,nodes:Ra,node:Ta,size:Ia,empty:Pa,each:Na,attr:za,style:Ua,property:Ka,classed:ja,text:is,html:os,raise:hs,lower:cs,append:fs,insert:gs,remove:ms,clone:xs,datum:bs,on:Ls,dispatch:Cs};function I(t){return typeof t=="string"?new W([[document.querySelector(t)]],[document.documentElement]):new W([[t]],Qi)}function Ji(){for(var t=_,e;e=t.sourceEvent;)t=e;return t}function ji(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}function Rs(t){var e=Ji();return e.changedTouches&&(e=e.changedTouches[0]),ji(t,e)}function Ts(t,e,n){arguments.length<3&&(n=e,e=Ji().changedTouches);for(var i=0,r=e?e.length:0,a;i<r;++i)if((a=e[i]).identifier===n)return ji(t,a);return null}function en(){_.stopImmediatePropagation()}function bt(){_.preventDefault(),_.stopImmediatePropagation()}function Is(t){var e=t.document.documentElement,n=I(t).on("dragstart.drag",bt,!0);"onselectstart"in e?n.on("selectstart.drag",bt,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ps(t,e){var n=t.document.documentElement,i=I(t).on("dragstart.drag",null);e&&(i.on("click.drag",bt,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function ne(t){return function(){return t}}function yn(t,e,n,i,r,a,s,o,l,h){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=a,this.y=s,this.dx=o,this.dy=l,this._=h}yn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Ns(){return!_.ctrlKey&&!_.button}function Es(){return this.parentNode}function Ys(t){return t??{x:_.x,y:_.y}}function Bs(){return navigator.maxTouchPoints||"ontouchstart"in this}function Hs(){var t=Ns,e=Es,n=Ys,i=Bs,r={},a=Be("start","drag","end"),s=0,o,l,h,f,c=0;function u(x){x.on("mousedown.drag",g).filter(i).on("touchstart.drag",m).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(){if(!(f||!t.apply(this,arguments))){var x=v("mouse",e.apply(this,arguments),Rs,this,arguments);x&&(I(_.view).on("mousemove.drag",d,!0).on("mouseup.drag",p,!0),Is(_.view),en(),h=!1,o=_.clientX,l=_.clientY,x("start"))}}function d(){if(bt(),!h){var x=_.clientX-o,M=_.clientY-l;h=x*x+M*M>c}r.mouse("drag")}function p(){I(_.view).on("mousemove.drag mouseup.drag",null),Ps(_.view,h),bt(),r.mouse("end")}function m(){if(t.apply(this,arguments)){var x=_.changedTouches,M=e.apply(this,arguments),k=x.length,S,R;for(S=0;S<k;++S)(R=v(x[S].identifier,M,Ts,this,arguments))&&(en(),R("start"))}}function y(){var x=_.changedTouches,M=x.length,k,S;for(k=0;k<M;++k)(S=r[x[k].identifier])&&(bt(),S("drag"))}function b(){var x=_.changedTouches,M=x.length,k,S;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),k=0;k<M;++k)(S=r[x[k].identifier])&&(en(),S("end"))}function v(x,M,k,S,R){var L=k(M,x),C,A,w,D=a.copy();if(ni(new yn(u,"beforestart",C,x,s,L[0],L[1],0,0,D),function(){return(_.subject=C=n.apply(S,R))==null?!1:(A=C.x-L[0]||0,w=C.y-L[1]||0,!0)}))return function N(X){var z=L,B;switch(X){case"start":r[x]=N,B=s++;break;case"end":delete r[x],--s;case"drag":L=k(M,x),B=s;break}ni(new yn(u,X,C,x,B,L[0]+A,L[1]+w,L[0]-z[0],L[1]-z[1],D),D.apply,D,[X,S,R])}}return u.filter=function(x){return arguments.length?(t=typeof x=="function"?x:ne(!!x),u):t},u.container=function(x){return arguments.length?(e=typeof x=="function"?x:ne(x),u):e},u.subject=function(x){return arguments.length?(n=typeof x=="function"?x:ne(x),u):n},u.touchable=function(x){return arguments.length?(i=typeof x=="function"?x:ne(!!x),u):i},u.on=function(){var x=a.on.apply(a,arguments);return x===a?u:x},u.clickDistance=function(x){return arguments.length?(c=(x=+x)*x,u):Math.sqrt(c)},u}function Rn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function tr(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Qt(){}var Gt=.7,ve=1/Gt,_t="\\s*([+-]?\\d+)\\s*",Ot="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",et="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$s=/^#([0-9a-f]{3,8})$/,Xs=new RegExp("^rgb\\("+[_t,_t,_t]+"\\)$"),zs=new RegExp("^rgb\\("+[et,et,et]+"\\)$"),Fs=new RegExp("^rgba\\("+[_t,_t,_t,Ot]+"\\)$"),Gs=new RegExp("^rgba\\("+[et,et,et,Ot]+"\\)$"),Os=new RegExp("^hsl\\("+[Ot,et,et]+"\\)$"),Us=new RegExp("^hsla\\("+[Ot,et,et,Ot]+"\\)$"),ii={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Rn(Qt,dt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:ri,formatHex:ri,formatHsl:Ws,formatRgb:ai,toString:ai});function ri(){return this.rgb().formatHex()}function Ws(){return er(this).formatHsl()}function ai(){return this.rgb().formatRgb()}function dt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=$s.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?si(e):n===3?new U(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ie(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ie(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Xs.exec(t))?new U(e[1],e[2],e[3],1):(e=zs.exec(t))?new U(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Fs.exec(t))?ie(e[1],e[2],e[3],e[4]):(e=Gs.exec(t))?ie(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Os.exec(t))?hi(e[1],e[2]/100,e[3]/100,1):(e=Us.exec(t))?hi(e[1],e[2]/100,e[3]/100,e[4]):ii.hasOwnProperty(t)?si(ii[t]):t==="transparent"?new U(NaN,NaN,NaN,0):null}function si(t){return new U(t>>16&255,t>>8&255,t&255,1)}function ie(t,e,n,i){return i<=0&&(t=e=n=NaN),new U(t,e,n,i)}function Vs(t){return t instanceof Qt||(t=dt(t)),t?(t=t.rgb(),new U(t.r,t.g,t.b,t.opacity)):new U}function xe(t,e,n,i){return arguments.length===1?Vs(t):new U(t,e,n,i??1)}function U(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}Rn(U,xe,tr(Qt,{brighter:function(t){return t=t==null?ve:Math.pow(ve,t),new U(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Gt:Math.pow(Gt,t),new U(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:oi,formatHex:oi,formatRgb:li,toString:li}));function oi(){return"#"+nn(this.r)+nn(this.g)+nn(this.b)}function li(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function nn(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function hi(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new j(t,e,n,i)}function er(t){if(t instanceof j)return new j(t.h,t.s,t.l,t.opacity);if(t instanceof Qt||(t=dt(t)),!t)return new j;if(t instanceof j)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),s=NaN,o=a-r,l=(a+r)/2;return o?(e===a?s=(n-i)/o+(n<i)*6:n===a?s=(i-e)/o+2:s=(e-n)/o+4,o/=l<.5?a+r:2-a-r,s*=60):o=l>0&&l<1?0:s,new j(s,o,l,t.opacity)}function qs(t,e,n,i){return arguments.length===1?er(t):new j(t,e,n,i??1)}function j(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Rn(j,qs,tr(Qt,{brighter:function(t){return t=t==null?ve:Math.pow(ve,t),new j(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Gt:Math.pow(Gt,t),new j(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new U(rn(t>=240?t-240:t+120,r,i),rn(t,r,i),rn(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function rn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function nr(t,e,n,i,r){var a=t*t,s=a*t;return((1-3*t+3*a-s)*e+(4-6*a+3*s)*n+(1+3*t+3*a-3*s)*i+s*r)/6}function Ks(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],s=i>0?t[i-1]:2*r-a,o=i<e-1?t[i+2]:2*a-r;return nr((n-i/e)*e,s,r,a,o)}}function Zs(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],s=t[(i+1)%e],o=t[(i+2)%e];return nr((n-i/e)*e,r,a,s,o)}}function $e(t){return function(){return t}}function ir(t,e){return function(n){return t+n*e}}function Qs(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Gu(t,e){var n=e-t;return n?ir(t,n>180||n<-180?n-360*Math.round(n/360):n):$e(isNaN(t)?e:t)}function Js(t){return(t=+t)==1?rr:function(e,n){return n-e?Qs(e,n,t):$e(isNaN(e)?n:e)}}function rr(t,e){var n=e-t;return n?ir(t,n):$e(isNaN(t)?e:t)}const be=function t(e){var n=Js(e);function i(r,a){var s=n((r=xe(r)).r,(a=xe(a)).r),o=n(r.g,a.g),l=n(r.b,a.b),h=rr(r.opacity,a.opacity);return function(f){return r.r=s(f),r.g=o(f),r.b=l(f),r.opacity=h(f),r+""}}return i.gamma=t,i}(1);function ar(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),a=new Array(n),s,o;for(s=0;s<n;++s)o=xe(e[s]),i[s]=o.r||0,r[s]=o.g||0,a[s]=o.b||0;return i=t(i),r=t(r),a=t(a),o.opacity=1,function(l){return o.r=i(l),o.g=r(l),o.b=a(l),o+""}}}var Ou=ar(Ks),Uu=ar(Zs);function sr(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(a){for(r=0;r<n;++r)i[r]=t[r]*(1-a)+e[r]*a;return i}}function or(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Wu(t,e){return(or(e)?sr:lr)(t,e)}function lr(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),a=new Array(n),s;for(s=0;s<i;++s)r[s]=Tn(t[s],e[s]);for(;s<n;++s)a[s]=e[s];return function(o){for(s=0;s<i;++s)a[s]=r[s](o);return a}}function js(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Z(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function to(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=Tn(t[r],e[r]):i[r]=e[r];return function(a){for(r in n)i[r]=n[r](a);return i}}var vn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,an=new RegExp(vn.source,"g");function eo(t){return function(){return t}}function no(t){return function(e){return t(e)+""}}function hr(t,e){var n=vn.lastIndex=an.lastIndex=0,i,r,a,s=-1,o=[],l=[];for(t=t+"",e=e+"";(i=vn.exec(t))&&(r=an.exec(e));)(a=r.index)>n&&(a=e.slice(n,a),o[s]?o[s]+=a:o[++s]=a),(i=i[0])===(r=r[0])?o[s]?o[s]+=r:o[++s]=r:(o[++s]=null,l.push({i:s,x:Z(i,r)})),n=an.lastIndex;return n<e.length&&(a=e.slice(n),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?no(l[0].x):eo(e):(e=l.length,function(h){for(var f=0,c;f<e;++f)o[(c=l[f]).i]=c.x(h);return o.join("")})}function Tn(t,e){var n=typeof e,i;return e==null||n==="boolean"?$e(e):(n==="number"?Z:n==="string"?(i=dt(e))?(e=i,be):hr:e instanceof dt?be:e instanceof Date?js:or(e)?sr:Array.isArray(e)?lr:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?to:Z)(t,e)}function io(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var ui=180/Math.PI,xn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ur(t,e,n,i,r,a){var s,o,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*ui,skewX:Math.atan(l)*ui,scaleX:s,scaleY:o}}var Pt,sn,ci,re;function ro(t){return t==="none"?xn:(Pt||(Pt=document.createElement("DIV"),sn=document.documentElement,ci=document.defaultView),Pt.style.transform=t,t=ci.getComputedStyle(sn.appendChild(Pt),null).getPropertyValue("transform"),sn.removeChild(Pt),t=t.slice(7,-1).split(","),ur(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function ao(t){return t==null||(re||(re=document.createElementNS("http://www.w3.org/2000/svg","g")),re.setAttribute("transform",t),!(t=re.transform.baseVal.consolidate()))?xn:(t=t.matrix,ur(t.a,t.b,t.c,t.d,t.e,t.f))}function cr(t,e,n,i){function r(h){return h.length?h.pop()+" ":""}function a(h,f,c,u,g,d){if(h!==c||f!==u){var p=g.push("translate(",null,e,null,n);d.push({i:p-4,x:Z(h,c)},{i:p-2,x:Z(f,u)})}else(c||u)&&g.push("translate("+c+e+u+n)}function s(h,f,c,u){h!==f?(h-f>180?f+=360:f-h>180&&(h+=360),u.push({i:c.push(r(c)+"rotate(",null,i)-2,x:Z(h,f)})):f&&c.push(r(c)+"rotate("+f+i)}function o(h,f,c,u){h!==f?u.push({i:c.push(r(c)+"skewX(",null,i)-2,x:Z(h,f)}):f&&c.push(r(c)+"skewX("+f+i)}function l(h,f,c,u,g,d){if(h!==c||f!==u){var p=g.push(r(g)+"scale(",null,",",null,")");d.push({i:p-4,x:Z(h,c)},{i:p-2,x:Z(f,u)})}else(c!==1||u!==1)&&g.push(r(g)+"scale("+c+","+u+")")}return function(h,f){var c=[],u=[];return h=t(h),f=t(f),a(h.translateX,h.translateY,f.translateX,f.translateY,c,u),s(h.rotate,f.rotate,c,u),o(h.skewX,f.skewX,c,u),l(h.scaleX,h.scaleY,f.scaleX,f.scaleY,c,u),h=f=null,function(g){for(var d=-1,p=u.length,m;++d<p;)c[(m=u[d]).i]=m.x(g);return c.join("")}}}var so=cr(ro,"px, ","px)","deg)"),oo=cr(ao,", ",")",")"),kt=0,Xt=0,Nt=0,fr=1e3,_e,zt,we=0,gt=0,Xe=0,Ut=typeof performance=="object"&&performance.now?performance:Date,dr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ze(){return gt||(dr(lo),gt=Ut.now()+Xe)}function lo(){gt=0}function Ae(){this._call=this._time=this._next=null}Ae.prototype=In.prototype={constructor:Ae,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?ze():+n)+(e==null?0:+e),!this._next&&zt!==this&&(zt?zt._next=this:_e=this,zt=this),this._call=t,this._time=n,bn()},stop:function(){this._call&&(this._call=null,this._time=1/0,bn())}};function In(t,e,n){var i=new Ae;return i.restart(t,e,n),i}function ho(){ze(),++kt;for(var t=_e,e;t;)(e=gt-t._time)>=0&&t._call.call(null,e),t=t._next;--kt}function fi(){gt=(we=Ut.now())+Xe,kt=Xt=0;try{ho()}finally{kt=0,co(),gt=0}}function uo(){var t=Ut.now(),e=t-we;e>fr&&(Xe-=e,we=t)}function co(){for(var t,e=_e,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:_e=n);zt=t,bn(i)}function bn(t){if(!kt){Xt&&(Xt=clearTimeout(Xt));var e=t-gt;e>24?(t<1/0&&(Xt=setTimeout(fi,t-Ut.now()-Xe)),Nt&&(Nt=clearInterval(Nt))):(Nt||(we=Ut.now(),Nt=setInterval(uo,fr)),kt=1,dr(fi))}}function di(t,e,n){var i=new Ae;return e=e==null?0:+e,i.restart(function(r){i.stop(),t(r+e)},e,n),i}var fo=Be("start","end","cancel","interrupt"),go=[],gr=0,gi=1,_n=2,de=3,pi=4,wn=5,ge=6;function Fe(t,e,n,i,r,a){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;po(t,n,{name:e,index:i,group:r,on:fo,tween:go,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:gr})}function Pn(t,e){var n=Q(t,e);if(n.state>gr)throw new Error("too late; already scheduled");return n}function ot(t,e){var n=Q(t,e);if(n.state>de)throw new Error("too late; already running");return n}function Q(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function po(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=In(a,0,n.time);function a(h){n.state=gi,n.timer.restart(s,n.delay,n.time),n.delay<=h&&s(h-n.delay)}function s(h){var f,c,u,g;if(n.state!==gi)return l();for(f in i)if(g=i[f],g.name===n.name){if(g.state===de)return di(s);g.state===pi?(g.state=ge,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete i[f]):+f<e&&(g.state=ge,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete i[f])}if(di(function(){n.state===de&&(n.state=pi,n.timer.restart(o,n.delay,n.time),o(h))}),n.state=_n,n.on.call("start",t,t.__data__,n.index,n.group),n.state===_n){for(n.state=de,r=new Array(u=n.tween.length),f=0,c=-1;f<u;++f)(g=n.tween[f].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=g);r.length=c+1}}function o(h){for(var f=h<n.duration?n.ease.call(null,h/n.duration):(n.timer.restart(l),n.state=wn,1),c=-1,u=r.length;++c<u;)r[c].call(t,f);n.state===wn&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=ge,n.timer.stop(),delete i[e];for(var h in i)return;delete t.__transition}}function mo(t,e){var n=t.__transition,i,r,a=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((i=n[s]).name!==e){a=!1;continue}r=i.state>_n&&i.state<wn,i.state=ge,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[s]}a&&delete t.__transition}}function yo(t){return this.each(function(){mo(this,t)})}function vo(t,e){var n,i;return function(){var r=ot(this,t),a=r.tween;if(a!==n){i=n=a;for(var s=0,o=i.length;s<o;++s)if(i[s].name===e){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function xo(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var a=ot(this,t),s=a.tween;if(s!==i){r=(i=s).slice();for(var o={name:e,value:n},l=0,h=r.length;l<h;++l)if(r[l].name===e){r[l]=o;break}l===h&&r.push(o)}a.tween=r}}function bo(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Q(this.node(),n).tween,r=0,a=i.length,s;r<a;++r)if((s=i[r]).name===t)return s.value;return null}return this.each((e==null?vo:xo)(n,t,e))}function Nn(t,e,n){var i=t._id;return t.each(function(){var r=ot(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Q(r,i).value[e]}}function pr(t,e){var n;return(typeof e=="number"?Z:e instanceof dt?be:(n=dt(e))?(e=n,be):hr)(t,e)}function _o(t){return function(){this.removeAttribute(t)}}function wo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ao(t,e,n){var i,r=n+"",a;return function(){var s=this.getAttribute(t);return s===r?null:s===i?a:a=e(i=s,n)}}function Mo(t,e,n){var i,r=n+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?a:a=e(i=s,n)}}function ko(t,e,n){var i,r,a;return function(){var s,o=n(this),l;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),l=o+"",s===l?null:s===i&&l===r?a:(r=l,a=e(i=s,o)))}}function Lo(t,e,n){var i,r,a;return function(){var s,o=n(this),l;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),l=o+"",s===l?null:s===i&&l===r?a:(r=l,a=e(i=s,o)))}}function Do(t,e){var n=He(t),i=n==="transform"?oo:pr;return this.attrTween(t,typeof e=="function"?(n.local?Lo:ko)(n,i,Nn(this,"attr."+t,e)):e==null?(n.local?wo:_o)(n):(n.local?Mo:Ao)(n,i,e))}function So(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Co(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ro(t,e){var n,i;function r(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&Co(t,a)),n}return r._value=e,r}function To(t,e){var n,i;function r(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&So(t,a)),n}return r._value=e,r}function Io(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=He(t);return this.tween(n,(i.local?Ro:To)(i,e))}function Po(t,e){return function(){Pn(this,t).delay=+e.apply(this,arguments)}}function No(t,e){return e=+e,function(){Pn(this,t).delay=e}}function Eo(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Po:No)(e,t)):Q(this.node(),e).delay}function Yo(t,e){return function(){ot(this,t).duration=+e.apply(this,arguments)}}function Bo(t,e){return e=+e,function(){ot(this,t).duration=e}}function Ho(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Yo:Bo)(e,t)):Q(this.node(),e).duration}function $o(t,e){if(typeof e!="function")throw new Error;return function(){ot(this,t).ease=e}}function Xo(t){var e=this._id;return arguments.length?this.each($o(e,t)):Q(this.node(),e).ease}function zo(t){typeof t!="function"&&(t=zi(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,o=i[r]=[],l,h=0;h<s;++h)(l=a[h])&&t.call(l,l.__data__,h,a)&&o.push(l);return new st(i,this._parents,this._name,this._id)}function Fo(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),s=new Array(i),o=0;o<a;++o)for(var l=e[o],h=n[o],f=l.length,c=s[o]=new Array(f),u,g=0;g<f;++g)(u=l[g]||h[g])&&(c[g]=u);for(;o<i;++o)s[o]=e[o];return new st(s,this._parents,this._name,this._id)}function Go(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Oo(t,e,n){var i,r,a=Go(e)?Pn:ot;return function(){var s=a(this,t),o=s.on;o!==i&&(r=(i=o).copy()).on(e,n),s.on=r}}function Uo(t,e){var n=this._id;return arguments.length<2?Q(this.node(),n).on.on(t):this.each(Oo(n,t,e))}function Wo(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Vo(){return this.on("end.remove",Wo(this._id))}function qo(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Sn(t));for(var i=this._groups,r=i.length,a=new Array(r),s=0;s<r;++s)for(var o=i[s],l=o.length,h=a[s]=new Array(l),f,c,u=0;u<l;++u)(f=o[u])&&(c=t.call(f,f.__data__,u,o))&&("__data__"in f&&(c.__data__=f.__data__),h[u]=c,Fe(h[u],e,n,u,h,Q(f,n)));return new st(a,this._parents,e,n)}function Ko(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Xi(t));for(var i=this._groups,r=i.length,a=[],s=[],o=0;o<r;++o)for(var l=i[o],h=l.length,f,c=0;c<h;++c)if(f=l[c]){for(var u=t.call(f,f.__data__,c,l),g,d=Q(f,n),p=0,m=u.length;p<m;++p)(g=u[p])&&Fe(g,e,n,p,u,d);a.push(u),s.push(f)}return new st(a,s,e,n)}var Zo=St.prototype.constructor;function Qo(){return new Zo(this._groups,this._parents)}function Jo(t,e){var n,i,r;return function(){var a=Mt(this,t),s=(this.style.removeProperty(t),Mt(this,t));return a===s?null:a===n&&s===i?r:r=e(n=a,i=s)}}function mr(t){return function(){this.style.removeProperty(t)}}function jo(t,e,n){var i,r=n+"",a;return function(){var s=Mt(this,t);return s===r?null:s===i?a:a=e(i=s,n)}}function tl(t,e,n){var i,r,a;return function(){var s=Mt(this,t),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(t),Mt(this,t))),s===l?null:s===i&&l===r?a:(r=l,a=e(i=s,o))}}function el(t,e){var n,i,r,a="style."+e,s="end."+a,o;return function(){var l=ot(this,t),h=l.on,f=l.value[a]==null?o||(o=mr(e)):void 0;(h!==n||r!==f)&&(i=(n=h).copy()).on(s,r=f),l.on=i}}function nl(t,e,n){var i=(t+="")=="transform"?so:pr;return e==null?this.styleTween(t,Jo(t,i)).on("end.style."+t,mr(t)):typeof e=="function"?this.styleTween(t,tl(t,i,Nn(this,"style."+t,e))).each(el(this._id,t)):this.styleTween(t,jo(t,i,e),n).on("end.style."+t,null)}function il(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function rl(t,e,n){var i,r;function a(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&il(t,s,n)),i}return a._value=e,a}function al(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,rl(t,e,n??""))}function sl(t){return function(){this.textContent=t}}function ol(t){return function(){var e=t(this);this.textContent=e??""}}function ll(t){return this.tween("text",typeof t=="function"?ol(Nn(this,"text",t)):sl(t==null?"":t+""))}function hl(t){return function(e){this.textContent=t.call(this,e)}}function ul(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&hl(r)),e}return i._value=t,i}function cl(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,ul(t))}function fl(){for(var t=this._name,e=this._id,n=yr(),i=this._groups,r=i.length,a=0;a<r;++a)for(var s=i[a],o=s.length,l,h=0;h<o;++h)if(l=s[h]){var f=Q(l,e);Fe(l,t,n,h,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new st(i,this._parents,t,n)}function dl(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(a,s){var o={value:s},l={value:function(){--r===0&&a()}};n.each(function(){var h=ot(this,i),f=h.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),h.on=e})})}var gl=0;function st(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function pl(t){return St().transition(t)}function yr(){return++gl}var pt=St.prototype;st.prototype=pl.prototype={constructor:st,select:qo,selectAll:Ko,filter:zo,merge:Fo,selection:Qo,transition:fl,call:pt.call,nodes:pt.nodes,node:pt.node,size:pt.size,empty:pt.empty,each:pt.each,on:Uo,attr:Do,attrTween:Io,style:nl,styleTween:al,text:ll,textTween:cl,remove:Vo,tween:bo,delay:Eo,duration:Ho,ease:Xo,end:dl};function Vu(t){return t*t*t}function qu(t){return--t*t*t+1}function ml(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function Me(t){return(Math.pow(2,-10*t)-.0009765625)*1.0009775171065494}var Lt=2*Math.PI,En=1,Yn=.3,Ku=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Lt);function r(a){return e*Me(- --a)*Math.sin((i-a)/n)}return r.amplitude=function(a){return t(a,n*Lt)},r.period=function(a){return t(e,a)},r}(En,Yn),yl=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Lt);function r(a){return 1-e*Me(a=+a)*Math.sin((a+i)/n)}return r.amplitude=function(a){return t(a,n*Lt)},r.period=function(a){return t(e,a)},r}(En,Yn),Zu=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Lt);function r(a){return((a=a*2-1)<0?e*Me(-a)*Math.sin((i-a)/n):2-e*Me(a)*Math.sin((i+a)/n))/2}return r.amplitude=function(a){return t(a,n*Lt)},r.period=function(a){return t(e,a)},r}(En,Yn),An={time:null,delay:0,duration:250,ease:ml};function vl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return An.time=ze(),An;return n}function xl(t){var e,n;t instanceof st?(e=t._id,t=t._name):(e=yr(),(n=An).time=ze(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var s=i[a],o=s.length,l,h=0;h<o;++h)(l=s[h])&&Fe(l,t,e,h,s,n||vl(l,e));return new st(i,this._parents,t,e)}St.prototype.interrupt=yo;St.prototype.transition=xl;var Mn=Math.PI,kn=2*Mn,ft=1e-6,bl=kn-ft;function Ln(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function vr(){return new Ln}Ln.prototype=vr.prototype={constructor:Ln,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,s=this._y1,o=n-t,l=i-e,h=a-t,f=s-e,c=h*h+f*f;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>ft)if(!(Math.abs(f*o-l*h)>ft)||!r)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var u=n-a,g=i-s,d=o*o+l*l,p=u*u+g*g,m=Math.sqrt(d),y=Math.sqrt(c),b=r*Math.tan((Mn-Math.acos((d+c-p)/(2*m*y)))/2),v=b/y,x=b/m;Math.abs(v-1)>ft&&(this._+="L"+(t+v*h)+","+(e+v*f)),this._+="A"+r+","+r+",0,0,"+ +(f*u>h*g)+","+(this._x1=t+x*o)+","+(this._y1=e+x*l)}},arc:function(t,e,n,i,r,a){t=+t,e=+e,n=+n,a=!!a;var s=n*Math.cos(i),o=n*Math.sin(i),l=t+s,h=e+o,f=1^a,c=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+l+","+h:(Math.abs(this._x1-l)>ft||Math.abs(this._y1-h)>ft)&&(this._+="L"+l+","+h),n&&(c<0&&(c=c%kn+kn),c>bl?this._+="A"+n+","+n+",0,1,"+f+","+(t-s)+","+(e-o)+"A"+n+","+n+",0,1,"+f+","+(this._x1=l)+","+(this._y1=h):c>ft&&(this._+="A"+n+","+n+",0,"+ +(c>=Mn)+","+f+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var V="$";function ke(){}ke.prototype=Wt.prototype={constructor:ke,has:function(t){return V+t in this},get:function(t){return this[V+t]},set:function(t,e){return this[V+t]=e,this},remove:function(t){var e=V+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===V&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===V&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===V&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===V&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===V&&++t;return t},empty:function(){for(var t in this)if(t[0]===V)return!1;return!0},each:function(t){for(var e in this)e[0]===V&&t(this[e],e.slice(1),this)}};function Wt(t,e){var n=new ke;if(t instanceof ke)t.each(function(o,l){n.set(l,o)});else if(Array.isArray(t)){var i=-1,r=t.length,a;if(e==null)for(;++i<r;)n.set(i,t[i]);else for(;++i<r;)n.set(e(a=t[i],i,t),a)}else if(t)for(var s in t)n.set(s,t[s]);return n}function Le(){}var ut=Wt.prototype;Le.prototype=_l.prototype={constructor:Le,has:ut.has,add:function(t){return t+="",this[V+t]=t,this},remove:ut.remove,clear:ut.clear,values:ut.keys,size:ut.size,empty:ut.empty,each:ut.each};function _l(t,e){var n=new Le;if(t instanceof Le)t.each(function(a){n.add(a)});else if(t){var i=-1,r=t.length;if(e==null)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}function q(t){return function(){return t}}function mt(){return(Math.random()-.5)*1e-6}function wl(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return xr(this.cover(e,n),e,n,t)}function xr(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a=t._root,s={data:i},o=t._x0,l=t._y0,h=t._x1,f=t._y1,c,u,g,d,p,m,y,b;if(!a)return t._root=s,t;for(;a.length;)if((p=e>=(c=(o+h)/2))?o=c:h=c,(m=n>=(u=(l+f)/2))?l=u:f=u,r=a,!(a=a[y=m<<1|p]))return r[y]=s,t;if(g=+t._x.call(null,a.data),d=+t._y.call(null,a.data),e===g&&n===d)return s.next=a,r?r[y]=s:t._root=s,t;do r=r?r[y]=new Array(4):t._root=new Array(4),(p=e>=(c=(o+h)/2))?o=c:h=c,(m=n>=(u=(l+f)/2))?l=u:f=u;while((y=m<<1|p)===(b=(d>=u)<<1|g>=c));return r[b]=a,r[y]=s,t}function Al(t){var e,n,i=t.length,r,a,s=new Array(i),o=new Array(i),l=1/0,h=1/0,f=-1/0,c=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(s[n]=r,o[n]=a,r<l&&(l=r),r>f&&(f=r),a<h&&(h=a),a>c&&(c=a));if(l>f||h>c)return this;for(this.cover(l,h).cover(f,c),n=0;n<i;++n)xr(this,s[n],o[n],t[n]);return this}function Ml(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var s=r-n,o=this._root,l,h;n>t||t>=r||i>e||e>=a;)switch(h=(e<i)<<1|t<n,l=new Array(4),l[h]=o,o=l,s*=2,h){case 0:r=n+s,a=i+s;break;case 1:n=r-s,a=i+s;break;case 2:r=n+s,i=a-s;break;case 3:n=r-s,i=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this}function kl(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Ll(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function H(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function Dl(t,e,n){var i,r=this._x0,a=this._y0,s,o,l,h,f=this._x1,c=this._y1,u=[],g=this._root,d,p;for(g&&u.push(new H(g,r,a,f,c)),n==null?n=1/0:(r=t-n,a=e-n,f=t+n,c=e+n,n*=n);d=u.pop();)if(!(!(g=d.node)||(s=d.x0)>f||(o=d.y0)>c||(l=d.x1)<r||(h=d.y1)<a))if(g.length){var m=(s+l)/2,y=(o+h)/2;u.push(new H(g[3],m,y,l,h),new H(g[2],s,y,m,h),new H(g[1],m,o,l,y),new H(g[0],s,o,m,y)),(p=(e>=y)<<1|t>=m)&&(d=u[u.length-1],u[u.length-1]=u[u.length-1-p],u[u.length-1-p]=d)}else{var b=t-+this._x.call(null,g.data),v=e-+this._y.call(null,g.data),x=b*b+v*v;if(x<n){var M=Math.sqrt(n=x);r=t-M,a=e-M,f=t+M,c=e+M,i=g.data}}return i}function Sl(t){if(isNaN(f=+this._x.call(null,t))||isNaN(c=+this._y.call(null,t)))return this;var e,n=this._root,i,r,a,s=this._x0,o=this._y0,l=this._x1,h=this._y1,f,c,u,g,d,p,m,y;if(!n)return this;if(n.length)for(;;){if((d=f>=(u=(s+l)/2))?s=u:l=u,(p=c>=(g=(o+h)/2))?o=g:h=g,e=n,!(n=n[m=p<<1|d]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(i=e,y=m)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,r?(a?r.next=a:delete r.next,this):e?(a?e[m]=a:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=a,this)}function Cl(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Rl(){return this._root}function Tl(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Il(t){var e=[],n,i=this._root,r,a,s,o,l;for(i&&e.push(new H(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,a=n.x0,s=n.y0,o=n.x1,l=n.y1)&&i.length){var h=(a+o)/2,f=(s+l)/2;(r=i[3])&&e.push(new H(r,h,f,o,l)),(r=i[2])&&e.push(new H(r,a,f,h,l)),(r=i[1])&&e.push(new H(r,h,s,o,f)),(r=i[0])&&e.push(new H(r,a,s,h,f))}return this}function Pl(t){var e=[],n=[],i;for(this._root&&e.push(new H(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var a,s=i.x0,o=i.y0,l=i.x1,h=i.y1,f=(s+l)/2,c=(o+h)/2;(a=r[0])&&e.push(new H(a,s,o,f,c)),(a=r[1])&&e.push(new H(a,f,o,l,c)),(a=r[2])&&e.push(new H(a,s,c,f,h)),(a=r[3])&&e.push(new H(a,f,c,l,h))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Nl(t){return t[0]}function El(t){return arguments.length?(this._x=t,this):this._x}function Yl(t){return t[1]}function Bl(t){return arguments.length?(this._y=t,this):this._y}function Bn(t,e,n){var i=new Hn(e??Nl,n??Yl,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function Hn(t,e,n,i,r,a){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function mi(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var $=Bn.prototype=Hn.prototype;$.copy=function(){var t=new Hn(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=mi(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=mi(i));return t};$.add=wl;$.addAll=Al;$.cover=Ml;$.data=kl;$.extent=Ll;$.find=Dl;$.remove=Sl;$.removeAll=Cl;$.root=Rl;$.size=Tl;$.visit=Il;$.visitAfter=Pl;$.x=El;$.y=Bl;function Hl(t){return t.x+t.vx}function $l(t){return t.y+t.vy}function Xl(t){var e,n,i=1,r=1;typeof t!="function"&&(t=q(t==null?1:+t));function a(){for(var l,h=e.length,f,c,u,g,d,p,m=0;m<r;++m)for(f=Bn(e,Hl,$l).visitAfter(s),l=0;l<h;++l)c=e[l],d=n[c.index],p=d*d,u=c.x+c.vx,g=c.y+c.vy,f.visit(y);function y(b,v,x,M,k){var S=b.data,R=b.r,L=d+R;if(S){if(S.index>c.index){var C=u-S.x-S.vx,A=g-S.y-S.vy,w=C*C+A*A;w<L*L&&(C===0&&(C=mt(),w+=C*C),A===0&&(A=mt(),w+=A*A),w=(L-(w=Math.sqrt(w)))/w*i,c.vx+=(C*=w)*(L=(R*=R)/(p+R)),c.vy+=(A*=w)*L,S.vx-=C*(L=1-L),S.vy-=A*L)}return}return v>u+L||M<u-L||x>g+L||k<g-L}}function s(l){if(l.data)return l.r=n[l.data.index];for(var h=l.r=0;h<4;++h)l[h]&&l[h].r>l.r&&(l.r=l[h].r)}function o(){if(e){var l,h=e.length,f;for(n=new Array(h),l=0;l<h;++l)f=e[l],n[f.index]=+t(f,l,e)}}return a.initialize=function(l){e=l,o()},a.iterations=function(l){return arguments.length?(r=+l,a):r},a.strength=function(l){return arguments.length?(i=+l,a):i},a.radius=function(l){return arguments.length?(t=typeof l=="function"?l:q(+l),o(),a):t},a}function zl(t){return t.x}function Fl(t){return t.y}var Gl=10,Ol=Math.PI*(3-Math.sqrt(5));function Ul(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),a=0,s=.6,o=Wt(),l=In(f),h=Be("tick","end");t==null&&(t=[]);function f(){c(),h.call("tick",e),n<i&&(l.stop(),h.call("end",e))}function c(d){var p,m=t.length,y;d===void 0&&(d=1);for(var b=0;b<d;++b)for(n+=(a-n)*r,o.each(function(v){v(n)}),p=0;p<m;++p)y=t[p],y.fx==null?y.x+=y.vx*=s:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=s:(y.y=y.fy,y.vy=0);return e}function u(){for(var d=0,p=t.length,m;d<p;++d){if(m=t[d],m.index=d,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var y=Gl*Math.sqrt(d),b=d*Ol;m.x=y*Math.cos(b),m.y=y*Math.sin(b)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function g(d){return d.initialize&&d.initialize(t),d}return u(),e={tick:c,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(d){return arguments.length?(t=d,u(),o.each(g),e):t},alpha:function(d){return arguments.length?(n=+d,e):n},alphaMin:function(d){return arguments.length?(i=+d,e):i},alphaDecay:function(d){return arguments.length?(r=+d,e):+r},alphaTarget:function(d){return arguments.length?(a=+d,e):a},velocityDecay:function(d){return arguments.length?(s=1-d,e):1-s},force:function(d,p){return arguments.length>1?(p==null?o.remove(d):o.set(d,g(p)),e):o.get(d)},find:function(d,p,m){var y=0,b=t.length,v,x,M,k,S;for(m==null?m=1/0:m*=m,y=0;y<b;++y)k=t[y],v=d-k.x,x=p-k.y,M=v*v+x*x,M<m&&(S=k,m=M);return S},on:function(d,p){return arguments.length>1?(h.on(d,p),e):h.on(d)}}}function Wl(){var t,e,n,i=q(-30),r,a=1,s=1/0,o=.81;function l(u){var g,d=t.length,p=Bn(t,zl,Fl).visitAfter(f);for(n=u,g=0;g<d;++g)e=t[g],p.visit(c)}function h(){if(t){var u,g=t.length,d;for(r=new Array(g),u=0;u<g;++u)d=t[u],r[d.index]=+i(d,u,t)}}function f(u){var g=0,d,p,m=0,y,b,v;if(u.length){for(y=b=v=0;v<4;++v)(d=u[v])&&(p=Math.abs(d.value))&&(g+=d.value,m+=p,y+=p*d.x,b+=p*d.y);u.x=y/m,u.y=b/m}else{d=u,d.x=d.data.x,d.y=d.data.y;do g+=r[d.data.index];while(d=d.next)}u.value=g}function c(u,g,d,p){if(!u.value)return!0;var m=u.x-e.x,y=u.y-e.y,b=p-g,v=m*m+y*y;if(b*b/o<v)return v<s&&(m===0&&(m=mt(),v+=m*m),y===0&&(y=mt(),v+=y*y),v<a&&(v=Math.sqrt(a*v)),e.vx+=m*u.value*n/v,e.vy+=y*u.value*n/v),!0;if(u.length||v>=s)return;(u.data!==e||u.next)&&(m===0&&(m=mt(),v+=m*m),y===0&&(y=mt(),v+=y*y),v<a&&(v=Math.sqrt(a*v)));do u.data!==e&&(b=r[u.data.index]*n/v,e.vx+=m*b,e.vy+=y*b);while(u=u.next)}return l.initialize=function(u){t=u,h()},l.strength=function(u){return arguments.length?(i=typeof u=="function"?u:q(+u),h(),l):i},l.distanceMin=function(u){return arguments.length?(a=u*u,l):Math.sqrt(a)},l.distanceMax=function(u){return arguments.length?(s=u*u,l):Math.sqrt(s)},l.theta=function(u){return arguments.length?(o=u*u,l):Math.sqrt(o)},l}function on(t){var e=q(.1),n,i,r;typeof t!="function"&&(t=q(t==null?0:+t));function a(o){for(var l=0,h=n.length,f;l<h;++l)f=n[l],f.vx+=(r[l]-f.x)*i[l]*o}function s(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}return a.initialize=function(o){n=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:q(+o),s(),a):e},a.x=function(o){return arguments.length?(t=typeof o=="function"?o:q(+o),s(),a):t},a}function ln(t){var e=q(.1),n,i,r;typeof t!="function"&&(t=q(t==null?0:+t));function a(o){for(var l=0,h=n.length,f;l<h;++l)f=n[l],f.vy+=(r[l]-f.y)*i[l]*o}function s(){if(n){var o,l=n.length;for(i=new Array(l),r=new Array(l),o=0;o<l;++o)i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}return a.initialize=function(o){n=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:q(+o),s(),a):e},a.y=function(o){return arguments.length?(t=typeof o=="function"?o:q(+o),s(),a):t},a}function Vl(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function De(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Dt(t){return t=De(Math.abs(t)),t?t[1]:NaN}function ql(t,e){return function(n,i){for(var r=n.length,a=[],s=0,o=t[0],l=0;r>0&&o>0&&(l+o+1>i&&(o=Math.max(1,i-l)),a.push(n.substring(r-=o,r+o)),!((l+=o+1)>i));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function Kl(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Zl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Se(t){if(!(e=Zl.exec(t)))throw new Error("invalid format: "+t);var e;return new $n({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Se.prototype=$n.prototype;function $n(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}$n.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ql(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var br;function Jl(t,e){var n=De(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(br=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return a===s?i:a>s?i+new Array(a-s+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+De(t,Math.max(0,e+a-1))[0]}function yi(t,e){var n=De(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const vi={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Vl,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return yi(t*100,e)},r:yi,s:Jl,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function xi(t){return t}var bi=Array.prototype.map,_i=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function jl(t){var e=t.grouping===void 0||t.thousands===void 0?xi:ql(bi.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?xi:Kl(bi.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function h(c){c=Se(c);var u=c.fill,g=c.align,d=c.sign,p=c.symbol,m=c.zero,y=c.width,b=c.comma,v=c.precision,x=c.trim,M=c.type;M==="n"?(b=!0,M="g"):vi[M]||(v===void 0&&(v=12),x=!0,M="g"),(m||u==="0"&&g==="=")&&(m=!0,u="0",g="=");var k=p==="$"?n:p==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",S=p==="$"?i:/[%p]/.test(M)?s:"",R=vi[M],L=/[defgprs%]/.test(M);v=v===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function C(A){var w=k,D=S,N,X,z;if(M==="c")D=R(A)+D,A="";else{A=+A;var B=A<0||1/A<0;if(A=isNaN(A)?l:R(Math.abs(A),v),x&&(A=Ql(A)),B&&+A==0&&d!=="+"&&(B=!1),w=(B?d==="("?d:o:d==="-"||d==="("?"":d)+w,D=(M==="s"?_i[8+br/3]:"")+D+(B&&d==="("?")":""),L){for(N=-1,X=A.length;++N<X;)if(z=A.charCodeAt(N),48>z||z>57){D=(z===46?r+A.slice(N+1):A.slice(N))+D,A=A.slice(0,N);break}}}b&&!m&&(A=e(A,1/0));var it=w.length+A.length+D.length,F=it<y?new Array(y-it+1).join(u):"";switch(b&&m&&(A=e(F+A,F.length?y-D.length:1/0),F=""),g){case"<":A=w+A+D+F;break;case"=":A=w+F+A+D;break;case"^":A=F.slice(0,it=F.length>>1)+w+A+D+F.slice(it);break;default:A=F+w+A+D;break}return a(A)}return C.toString=function(){return c+""},C}function f(c,u){var g=h((c=Se(c),c.type="f",c)),d=Math.max(-8,Math.min(8,Math.floor(Dt(u)/3)))*3,p=Math.pow(10,-d),m=_i[8+d/3];return function(y){return g(p*y)+m}}return{format:h,formatPrefix:f}}var ae,Xn,_r;th({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function th(t){return ae=jl(t),Xn=ae.format,_r=ae.formatPrefix,ae}function eh(t){return Math.max(0,-Dt(Math.abs(t)))}function nh(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Dt(e)/3)))*3-Dt(Math.abs(t)))}function ih(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Dt(e)-Dt(t))+1}function Ct(){return Math.random()}const Qu=function t(e){function n(i,r){return i=i==null?0:+i,r=r==null?1:+r,arguments.length===1?(r=i,i=0):r-=i,function(){return e()*r+i}}return n.source=t,n}(Ct),rh=function t(e){function n(i,r){var a,s;return i=i==null?0:+i,r=r==null?1:+r,function(){var o;if(a!=null)o=a,a=null;else do a=e()*2-1,o=e()*2-1,s=a*a+o*o;while(!s||s>1);return i+r*o*Math.sqrt(-2*Math.log(s)/s)}}return n.source=t,n}(Ct),Ju=function t(e){function n(){var i=rh.source(e).apply(this,arguments);return function(){return Math.exp(i())}}return n.source=t,n}(Ct),ah=function t(e){function n(i){return function(){for(var r=0,a=0;a<i;++a)r+=e();return r}}return n.source=t,n}(Ct),ju=function t(e){function n(i){var r=ah.source(e)(i);return function(){return r()/i}}return n.source=t,n}(Ct),tc=function t(e){function n(i){return function(){return-Math.log(1-e())/i}}return n.source=t,n}(Ct);function Jt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ec(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t);break}return this}var wr=Array.prototype,sh=wr.map,Ce=wr.slice,wi={name:"implicit"};function Ge(){var t=Wt(),e=[],n=[],i=wi;function r(a){var s=a+"",o=t.get(s);if(!o){if(i!==wi)return i;t.set(s,o=e.push(a))}return n[(o-1)%n.length]}return r.domain=function(a){if(!arguments.length)return e.slice();e=[],t=Wt();for(var s=-1,o=a.length,l,h;++s<o;)t.has(h=(l=a[s])+"")||t.set(h,e.push(l));return r},r.range=function(a){return arguments.length?(n=Ce.call(a),r):n.slice()},r.unknown=function(a){return arguments.length?(i=a,r):i},r.copy=function(){return Ge(e,n).unknown(i)},Jt.apply(r,arguments),r}function Ar(){var t=Ge().unknown(void 0),e=t.domain,n=t.range,i=[0,1],r,a,s=!1,o=0,l=0,h=.5;delete t.unknown;function f(){var c=e().length,u=i[1]<i[0],g=i[u-0],d=i[1-u];r=(d-g)/Math.max(1,c-o+l*2),s&&(r=Math.floor(r)),g+=(d-g-r*(c-o))*h,a=r*(1-o),s&&(g=Math.round(g),a=Math.round(a));var p=Qr(c).map(function(m){return g+r*m});return n(u?p.reverse():p)}return t.domain=function(c){return arguments.length?(e(c),f()):e()},t.range=function(c){return arguments.length?(i=[+c[0],+c[1]],f()):i.slice()},t.rangeRound=function(c){return i=[+c[0],+c[1]],s=!0,f()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(c){return arguments.length?(s=!!c,f()):s},t.padding=function(c){return arguments.length?(o=Math.min(1,l=+c),f()):o},t.paddingInner=function(c){return arguments.length?(o=Math.min(1,c),f()):o},t.paddingOuter=function(c){return arguments.length?(l=+c,f()):l},t.align=function(c){return arguments.length?(h=Math.max(0,Math.min(1,c)),f()):h},t.copy=function(){return Ar(e(),i).round(s).paddingInner(o).paddingOuter(l).align(h)},Jt.apply(f(),arguments)}function Mr(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Mr(e())},t}function kr(){return Mr(Ar.apply(null,arguments).paddingInner(1))}function oh(t){return function(){return t}}function lh(t){return+t}var Ai=[0,1];function tt(t){return t}function Dn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:oh(isNaN(e)?NaN:.5)}function Mi(t){var e=t[0],n=t[t.length-1],i;return e>n&&(i=e,e=n,n=i),function(r){return Math.max(e,Math.min(n,r))}}function hh(t,e,n){var i=t[0],r=t[1],a=e[0],s=e[1];return r<i?(i=Dn(r,i),a=n(s,a)):(i=Dn(i,r),a=n(a,s)),function(o){return a(i(o))}}function uh(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=Dn(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(o){var l=Hi(t,o,1,i)-1;return a[l](r[l](o))}}function Lr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Dr(){var t=Ai,e=Ai,n=Tn,i,r,a,s=tt,o,l,h;function f(){return o=Math.min(t.length,e.length)>2?uh:hh,l=h=null,c}function c(u){return isNaN(u=+u)?a:(l||(l=o(t.map(i),e,n)))(i(s(u)))}return c.invert=function(u){return s(r((h||(h=o(e,t.map(i),Z)))(u)))},c.domain=function(u){return arguments.length?(t=sh.call(u,lh),s===tt||(s=Mi(t)),f()):t.slice()},c.range=function(u){return arguments.length?(e=Ce.call(u),f()):e.slice()},c.rangeRound=function(u){return e=Ce.call(u),n=io,f()},c.clamp=function(u){return arguments.length?(s=u?Mi(t):tt,c):s!==tt},c.interpolate=function(u){return arguments.length?(n=u,f()):n},c.unknown=function(u){return arguments.length?(a=u,c):a},function(u,g){return i=u,r=g,f()}}function ch(t,e){return Dr()(t,e)}function fh(t,e,n,i){var r=jr(t,e,n),a;switch(i=Se(i??",f"),i.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(a=nh(r,s))&&(i.precision=a),_r(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(a=ih(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=a-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(a=eh(r))&&(i.precision=a-(i.type==="%")*2);break}}return Xn(i)}function zn(t){var e=t.domain;return t.ticks=function(n){var i=e();return Jr(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return fh(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,a=i.length-1,s=i[r],o=i[a],l;return o<s&&(l=s,s=o,o=l,l=r,r=a,a=l),l=he(s,o,n),l>0?(s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l,l=he(s,o,n)):l<0&&(s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l,l=he(s,o,n)),l>0?(i[r]=Math.floor(s/l)*l,i[a]=Math.ceil(o/l)*l,e(i)):l<0&&(i[r]=Math.ceil(s*l)/l,i[a]=Math.floor(o*l)/l,e(i)),t},t}function Oe(){var t=ch(tt,tt);return t.copy=function(){return Lr(t,Oe())},Jt.apply(t,arguments),zn(t)}function ki(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function dh(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function gh(t){return t<0?-t*t:t*t}function ph(t){var e=t(tt,tt),n=1;function i(){return n===1?t(tt,tt):n===.5?t(dh,gh):t(ki(n),ki(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,i()):n},zn(e)}function Fn(){var t=ph(Dr());return t.copy=function(){return Lr(t,Fn()).exponent(t.exponent())},Jt.apply(t,arguments),t}function nc(){return Fn.apply(null,arguments).exponent(.5)}function Sr(){var t=0,e=1,n=1,i=[.5],r=[0,1],a;function s(l){return l<=l?r[Hi(i,l,0,n)]:a}function o(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*e-(l-n)*t)/(n+1);return s}return s.domain=function(l){return arguments.length?(t=+l[0],e=+l[1],o()):[t,e]},s.range=function(l){return arguments.length?(n=(r=Ce.call(l)).length-1,o()):r.slice()},s.invertExtent=function(l){var h=r.indexOf(l);return h<0?[NaN,NaN]:h<1?[t,i[0]]:h>=n?[i[n-1],e]:[i[h-1],i[h]]},s.unknown=function(l){return arguments.length&&(a=l),s},s.thresholds=function(){return i.slice()},s.copy=function(){return Sr().domain([t,e]).range(r).unknown(a)},Jt.apply(zn(s),arguments)}function lt(t){return function(){return t}}var Li=Math.abs,E=Math.atan2,ct=Math.cos,mh=Math.max,hn=Math.min,J=Math.sin,yt=Math.sqrt,G=1e-12,Vt=Math.PI,Re=Vt/2,yh=2*Vt;function vh(t){return t>1?0:t<-1?Vt:Math.acos(t)}function Di(t){return t>=1?Re:t<=-1?-Re:Math.asin(t)}function xh(t){return t.innerRadius}function bh(t){return t.outerRadius}function _h(t){return t.startAngle}function wh(t){return t.endAngle}function Ah(t){return t&&t.padAngle}function Mh(t,e,n,i,r,a,s,o){var l=n-t,h=i-e,f=s-r,c=o-a,u=c*l-f*h;if(!(u*u<G))return u=(f*(e-a)-c*(t-r))/u,[t+u*l,e+u*h]}function se(t,e,n,i,r,a,s){var o=t-n,l=e-i,h=(s?a:-a)/yt(o*o+l*l),f=h*l,c=-h*o,u=t+f,g=e+c,d=n+f,p=i+c,m=(u+d)/2,y=(g+p)/2,b=d-u,v=p-g,x=b*b+v*v,M=r-a,k=u*p-d*g,S=(v<0?-1:1)*yt(mh(0,M*M*x-k*k)),R=(k*v-b*S)/x,L=(-k*b-v*S)/x,C=(k*v+b*S)/x,A=(-k*b+v*S)/x,w=R-m,D=L-y,N=C-m,X=A-y;return w*w+D*D>N*N+X*X&&(R=C,L=A),{cx:R,cy:L,x01:-f,y01:-c,x11:R*(r/M-1),y11:L*(r/M-1)}}function kh(){var t=xh,e=bh,n=lt(0),i=null,r=_h,a=wh,s=Ah,o=null;function l(){var h,f,c=+t.apply(this,arguments),u=+e.apply(this,arguments),g=r.apply(this,arguments)-Re,d=a.apply(this,arguments)-Re,p=Li(d-g),m=d>g;if(o||(o=h=vr()),u<c&&(f=u,u=c,c=f),!(u>G))o.moveTo(0,0);else if(p>yh-G)o.moveTo(u*ct(g),u*J(g)),o.arc(0,0,u,g,d,!m),c>G&&(o.moveTo(c*ct(d),c*J(d)),o.arc(0,0,c,d,g,m));else{var y=g,b=d,v=g,x=d,M=p,k=p,S=s.apply(this,arguments)/2,R=S>G&&(i?+i.apply(this,arguments):yt(c*c+u*u)),L=hn(Li(u-c)/2,+n.apply(this,arguments)),C=L,A=L,w,D;if(R>G){var N=Di(R/c*J(S)),X=Di(R/u*J(S));(M-=N*2)>G?(N*=m?1:-1,v+=N,x-=N):(M=0,v=x=(g+d)/2),(k-=X*2)>G?(X*=m?1:-1,y+=X,b-=X):(k=0,y=b=(g+d)/2)}var z=u*ct(y),B=u*J(y),it=c*ct(x),F=c*J(x);if(L>G){var te=u*ct(b),ee=u*J(b),Ve=c*ct(v),qe=c*J(v),rt;if(p<Vt&&(rt=Mh(z,B,Ve,qe,te,ee,it,F))){var Ke=z-rt[0],Ze=B-rt[1],Qe=te-rt[0],Je=ee-rt[1],Wn=1/J(vh((Ke*Qe+Ze*Je)/(yt(Ke*Ke+Ze*Ze)*yt(Qe*Qe+Je*Je)))/2),Vn=yt(rt[0]*rt[0]+rt[1]*rt[1]);C=hn(L,(c-Vn)/(Wn-1)),A=hn(L,(u-Vn)/(Wn+1))}}k>G?A>G?(w=se(Ve,qe,z,B,u,A,m),D=se(te,ee,it,F,u,A,m),o.moveTo(w.cx+w.x01,w.cy+w.y01),A<L?o.arc(w.cx,w.cy,A,E(w.y01,w.x01),E(D.y01,D.x01),!m):(o.arc(w.cx,w.cy,A,E(w.y01,w.x01),E(w.y11,w.x11),!m),o.arc(0,0,u,E(w.cy+w.y11,w.cx+w.x11),E(D.cy+D.y11,D.cx+D.x11),!m),o.arc(D.cx,D.cy,A,E(D.y11,D.x11),E(D.y01,D.x01),!m))):(o.moveTo(z,B),o.arc(0,0,u,y,b,!m)):o.moveTo(z,B),!(c>G)||!(M>G)?o.lineTo(it,F):C>G?(w=se(it,F,te,ee,c,-C,m),D=se(z,B,Ve,qe,c,-C,m),o.lineTo(w.cx+w.x01,w.cy+w.y01),C<L?o.arc(w.cx,w.cy,C,E(w.y01,w.x01),E(D.y01,D.x01),!m):(o.arc(w.cx,w.cy,C,E(w.y01,w.x01),E(w.y11,w.x11),!m),o.arc(0,0,c,E(w.cy+w.y11,w.cx+w.x11),E(D.cy+D.y11,D.cx+D.x11),m),o.arc(D.cx,D.cy,C,E(D.y11,D.x11),E(D.y01,D.x01),!m))):o.arc(0,0,c,x,v,m)}if(o.closePath(),h)return o=null,h+""||null}return l.centroid=function(){var h=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,f=(+r.apply(this,arguments)+ +a.apply(this,arguments))/2-Vt/2;return[ct(f)*h,J(f)*h]},l.innerRadius=function(h){return arguments.length?(t=typeof h=="function"?h:lt(+h),l):t},l.outerRadius=function(h){return arguments.length?(e=typeof h=="function"?h:lt(+h),l):e},l.cornerRadius=function(h){return arguments.length?(n=typeof h=="function"?h:lt(+h),l):n},l.padRadius=function(h){return arguments.length?(i=h==null?null:typeof h=="function"?h:lt(+h),l):i},l.startAngle=function(h){return arguments.length?(r=typeof h=="function"?h:lt(+h),l):r},l.endAngle=function(h){return arguments.length?(a=typeof h=="function"?h:lt(+h),l):a},l.padAngle=function(h){return arguments.length?(s=typeof h=="function"?h:lt(+h),l):s},l.context=function(h){return arguments.length?(o=h??null,l):o},l}function Te(){this._=null}function Ue(t){t.U=t.C=t.L=t.R=t.P=t.N=null}Te.prototype={constructor:Te,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Si(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Et(this,n),t=n,n=t.U),n.C=!1,i.C=!0,Yt(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Yt(this,n),t=n,n=t.U),n.C=!1,i.C=!0,Et(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,i=t.L,r=t.R,a,s;if(i?r?a=Si(r):a=i:a=r,e?e.L===t?e.L=a:e.R=a:this._=a,i&&r?(s=a.C,a.C=t.C,a.L=i,i.U=a,a!==r?(e=a.U,a.U=t.U,t=a.R,e.L=t,a.R=r,r.U=a):(a.U=e,e=a,t=a.R)):(s=t.C,t=a),t&&(t.U=e),!s){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,Et(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,Yt(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,Et(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,Yt(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,Et(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,Yt(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function Et(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Yt(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Si(t){for(;t.L;)t=t.L;return t}function Ft(t,e,n,i){var r=[null,null],a=Y.push(r)-1;return r.left=t,r.right=e,n&&Ie(r,t,e,n),i&&Ie(r,e,t,i),O[t.index].halfedges.push(a),O[e.index].halfedges.push(a),r}function Bt(t,e,n){var i=[e,n];return i.left=t,i}function Ie(t,e,n,i){!t[0]&&!t[1]?(t[0]=i,t.left=e,t.right=n):t.left===n?t[1]=i:t[0]=i}function Lh(t,e,n,i,r){var a=t[0],s=t[1],o=a[0],l=a[1],h=s[0],f=s[1],c=0,u=1,g=h-o,d=f-l,p;if(p=e-o,!(!g&&p>0)){if(p/=g,g<0){if(p<c)return;p<u&&(u=p)}else if(g>0){if(p>u)return;p>c&&(c=p)}if(p=i-o,!(!g&&p<0)){if(p/=g,g<0){if(p>u)return;p>c&&(c=p)}else if(g>0){if(p<c)return;p<u&&(u=p)}if(p=n-l,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<u&&(u=p)}else if(d>0){if(p>u)return;p>c&&(c=p)}if(p=r-l,!(!d&&p<0)){if(p/=d,d<0){if(p>u)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<u&&(u=p)}return!(c>0)&&!(u<1)||(c>0&&(t[0]=[o+c*g,l+c*d]),u<1&&(t[1]=[o+u*g,l+u*d])),!0}}}}}function Dh(t,e,n,i,r){var a=t[1];if(a)return!0;var s=t[0],o=t.left,l=t.right,h=o[0],f=o[1],c=l[0],u=l[1],g=(h+c)/2,d=(f+u)/2,p,m;if(u===f){if(g<e||g>=i)return;if(h>c){if(!s)s=[g,n];else if(s[1]>=r)return;a=[g,r]}else{if(!s)s=[g,r];else if(s[1]<n)return;a=[g,n]}}else if(p=(h-c)/(u-f),m=d-p*g,p<-1||p>1)if(h>c){if(!s)s=[(n-m)/p,n];else if(s[1]>=r)return;a=[(r-m)/p,r]}else{if(!s)s=[(r-m)/p,r];else if(s[1]<n)return;a=[(n-m)/p,n]}else if(f<u){if(!s)s=[e,p*e+m];else if(s[0]>=i)return;a=[i,p*i+m]}else{if(!s)s=[i,p*i+m];else if(s[0]<e)return;a=[e,p*e+m]}return t[0]=s,t[1]=a,!0}function Sh(t,e,n,i){for(var r=Y.length,a;r--;)(!Dh(a=Y[r],t,e,n,i)||!Lh(a,t,e,n,i)||!(Math.abs(a[0][0]-a[1][0])>T||Math.abs(a[0][1]-a[1][1])>T))&&delete Y[r]}function Ch(t){return O[t.index]={site:t,halfedges:[]}}function Rh(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function Cr(t,e){return e[+(e.left!==t.site)]}function Th(t,e){return e[+(e.left===t.site)]}function Ih(){for(var t=0,e=O.length,n,i,r,a;t<e;++t)if((n=O[t])&&(a=(i=n.halfedges).length)){var s=new Array(a),o=new Array(a);for(r=0;r<a;++r)s[r]=r,o[r]=Rh(n,Y[i[r]]);for(s.sort(function(l,h){return o[h]-o[l]}),r=0;r<a;++r)o[r]=i[s[r]];for(r=0;r<a;++r)i[r]=o[r]}}function Ph(t,e,n,i){var r=O.length,a,s,o,l,h,f,c,u,g,d,p,m,y=!0;for(a=0;a<r;++a)if(s=O[a]){for(o=s.site,h=s.halfedges,l=h.length;l--;)Y[h[l]]||h.splice(l,1);for(l=0,f=h.length;l<f;)d=Th(s,Y[h[l]]),p=d[0],m=d[1],c=Cr(s,Y[h[++l%f]]),u=c[0],g=c[1],(Math.abs(p-u)>T||Math.abs(m-g)>T)&&(h.splice(l,0,Y.push(Bt(o,d,Math.abs(p-t)<T&&i-m>T?[t,Math.abs(u-t)<T?g:i]:Math.abs(m-i)<T&&n-p>T?[Math.abs(g-i)<T?u:n,i]:Math.abs(p-n)<T&&m-e>T?[n,Math.abs(u-n)<T?g:e]:Math.abs(m-e)<T&&p-t>T?[Math.abs(g-e)<T?u:t,e]:null))-1),++f);f&&(y=!1)}if(y){var b,v,x,M=1/0;for(a=0,y=null;a<r;++a)(s=O[a])&&(o=s.site,b=o[0]-t,v=o[1]-e,x=b*b+v*v,x<M&&(M=x,y=s));if(y){var k=[t,e],S=[t,i],R=[n,i],L=[n,e];y.halfedges.push(Y.push(Bt(o=y.site,k,S))-1,Y.push(Bt(o,S,R))-1,Y.push(Bt(o,R,L))-1,Y.push(Bt(o,L,k))-1)}}for(a=0;a<r;++a)(s=O[a])&&(s.halfedges.length||delete O[a])}var Rr=[],Gn;function Nh(){Ue(this),this.x=this.y=this.arc=this.site=this.cy=null}function vt(t){var e=t.P,n=t.N;if(!(!e||!n)){var i=e.site,r=t.site,a=n.site;if(i!==a){var s=r[0],o=r[1],l=i[0]-s,h=i[1]-o,f=a[0]-s,c=a[1]-o,u=2*(l*c-h*f);if(!(u>=-$h)){var g=l*l+h*h,d=f*f+c*c,p=(c*g-h*d)/u,m=(l*d-f*g)/u,y=Rr.pop()||new Nh;y.arc=t,y.site=r,y.x=p+s,y.y=(y.cy=m+o)+Math.sqrt(p*p+m*m),t.circle=y;for(var b=null,v=qt._;v;)if(y.y<v.y||y.y===v.y&&y.x<=v.x)if(v.L)v=v.L;else{b=v.P;break}else if(v.R)v=v.R;else{b=v;break}qt.insert(b,y),b||(Gn=y)}}}}function wt(t){var e=t.circle;e&&(e.P||(Gn=e.N),qt.remove(e),Rr.push(e),Ue(e),t.circle=null)}var Tr=[];function Eh(){Ue(this),this.edge=this.site=this.circle=null}function Ci(t){var e=Tr.pop()||new Eh;return e.site=t,e}function un(t){wt(t),At.remove(t),Tr.push(t),Ue(t)}function Yh(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],a=t.P,s=t.N,o=[t];un(t);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<T&&Math.abs(i-l.circle.cy)<T;)a=l.P,o.unshift(l),un(l),l=a;o.unshift(l),wt(l);for(var h=s;h.circle&&Math.abs(n-h.circle.x)<T&&Math.abs(i-h.circle.cy)<T;)s=h.N,o.push(h),un(h),h=s;o.push(h),wt(h);var f=o.length,c;for(c=1;c<f;++c)h=o[c],l=o[c-1],Ie(h.edge,l.site,h.site,r);l=o[0],h=o[f-1],h.edge=Ft(l.site,h.site,null,r),vt(l),vt(h)}function Bh(t){for(var e=t[0],n=t[1],i,r,a,s,o=At._;o;)if(a=Ir(o,n)-e,a>T)o=o.L;else if(s=e-Hh(o,n),s>T){if(!o.R){i=o;break}o=o.R}else{a>-T?(i=o.P,r=o):s>-T?(i=o,r=o.N):i=r=o;break}Ch(t);var l=Ci(t);if(At.insert(i,l),!(!i&&!r)){if(i===r){wt(i),r=Ci(i.site),At.insert(l,r),l.edge=r.edge=Ft(i.site,l.site),vt(i),vt(r);return}if(!r){l.edge=Ft(i.site,l.site);return}wt(i),wt(r);var h=i.site,f=h[0],c=h[1],u=t[0]-f,g=t[1]-c,d=r.site,p=d[0]-f,m=d[1]-c,y=2*(u*m-g*p),b=u*u+g*g,v=p*p+m*m,x=[(m*b-g*v)/y+f,(u*v-p*b)/y+c];Ie(r.edge,h,d,x),l.edge=Ft(h,t,null,x),r.edge=Ft(t,d,null,x),vt(i),vt(r)}}function Ir(t,e){var n=t.site,i=n[0],r=n[1],a=r-e;if(!a)return i;var s=t.P;if(!s)return-1/0;n=s.site;var o=n[0],l=n[1],h=l-e;if(!h)return o;var f=o-i,c=1/a-1/h,u=f/h;return c?(-u+Math.sqrt(u*u-2*c*(f*f/(-2*h)-l+h/2+r-a/2)))/c+i:(i+o)/2}function Hh(t,e){var n=t.N;if(n)return Ir(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var T=1e-6,$h=1e-12,At,O,qt,Y;function Xh(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function zh(t,e){return e[1]-t[1]||e[0]-t[0]}function Ri(t,e){var n=t.sort(zh).pop(),i,r,a;for(Y=[],O=new Array(t.length),At=new Te,qt=new Te;;)if(a=Gn,n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x))(n[0]!==i||n[1]!==r)&&(Bh(n),i=n[0],r=n[1]),n=t.pop();else if(a)Yh(a.arc);else break;if(Ih(),e){var s=+e[0][0],o=+e[0][1],l=+e[1][0],h=+e[1][1];Sh(s,o,l,h),Ph(s,o,l,h)}this.edges=Y,this.cells=O,At=qt=Y=O=null}Ri.prototype={constructor:Ri,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(i){return Cr(e,t[i])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,i){if(o=(a=n.halfedges).length)for(var r=n.site,a,s=-1,o,l,h=e[a[o-1]],f=h.left===r?h.right:h.left;++s<o;)l=f,h=e[a[s]],f=h.left===r?h.right:h.left,l&&f&&i<l.index&&i<f.index&&Xh(r,l,f)<0&&t.push([r.data,l.data,f.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var i=this,r,a=i._found||0,s=i.cells.length,o;!(o=i.cells[a]);)if(++a>=s)return null;var l=t-o.site[0],h=e-o.site[1],f=l*l+h*h;do o=i.cells[r=a],a=null,o.halfedges.forEach(function(c){var u=i.edges[c],g=u.left;if(!((g===o.site||!g)&&!(g=u.right))){var d=t-g[0],p=e-g[1],m=d*d+p*p;m<f&&(f=m,a=g.index)}});while(a!==null);return i._found=r,n==null||f<=n*n?o.site:null}};function xt(t,e,n){this.k=t,this.x=e,this.y=n}xt.prototype={constructor:xt,scale:function(t){return t===1?this:new xt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new xt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Fh=new xt(1,0,0);Gh.prototype=xt.prototype;function Gh(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Fh;return t.__zoom}const Pr=(t,e=250)=>{let n;return(...i)=>{let r;return n&&clearTimeout(n),n=setTimeout(()=>{r=t(...i)},e),r}};function Oh({D3Module:t,props:e,listenersKeys:n}){const i=at(void 0),r=at(),s=Pr(()=>{i.value&&i.value.render&&i.value.render()}),o=d=>d&&i.value.setParams&&i.value.setParams(d),l=d=>d&&i.value.setData&&i.value.setData(d),h=d=>d&&i.value.setDataset&&i.value.setDataset(d),f=d=>d&&i.value.setDatum&&i.value.setDatum(d),c=d=>d&&i.value.filter&&i.value.filter(d),u=({width:d,height:p})=>{i.value.resize&&i.value.resize({width:d&&typeof d=="number"?d:i.value.width,height:p&&typeof p=="number"?p:i.value.height})},g=d=>{d&&i.value.zoom&&i.value.transform&&i.value.transformZoom&&i.value.initZoom&&(i.value.initZoom(i.value.zoom),i.value.transformZoom(d))};return K(()=>e.params,d=>{o(d||{})}),K(()=>e.data,d=>{l(d)}),K(()=>e.dataset,d=>{h(d)}),K(()=>e.datum,d=>{f(d)}),K(()=>e.filter,d=>{c(d)}),K(()=>[e.width,e.height],({width:d,height:p})=>{(e.width||e.height)&&u({width:d,height:p})}),K(()=>e.zoom,d=>{g(d)}),{d3Module:i,debounceRender:s,createModule(d){r.value=d,i.value=new t(I(d),e.params||{}),o(e.params||{}),l(e.data),h(e.dataset),f(e.datum),c(e.filter),u({width:e.width,height:e.height}),g(e.zoom)},eventHandler(d){let p=d;n.forEach(m=>{i.value.on!=null&&i.value.on(m,y=>{p&&(console.log(m,y),p(m,y))})})}}}function Uh(t){const e=at({x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0}),n=Pr(r=>{const a=r[0];e.value=a.contentRect});return new ResizeObserver((r,a)=>{n(r)}).observe(t),e}const cn=800,Ti=500,Wh=(t,e)=>e?Object.keys(e):t?Object.keys(t).filter(n=>n.substring(0,2)==="on").map(n=>`${n.substring(2,3).toLowerCase()}${n.substring(3,n.length)}`):[],Vh=Or({props:{module:{},params:{},data:{},datum:{},dataset:{},filter:{},width:{default:()=>0},height:{default:()=>0},forceFit:{default:()=>!0},zoom:{}},setup(t,{emit:e,listeners:n}){const i=Ur(),r=Wh(i,n),a=at(null),s=at(null),o=qn(()=>{let p=`${cn}px`;return t.forceFit&&!t.width?p="100%":typeof t.width=="string"?p=t.width:typeof t.width=="number"&&t.width?p=`${t.width}px`:p=`${cn}px`,p}),l=qn(()=>{let p=`${Ti}px`;return typeof t.height=="string"?p=t.height:typeof t.height=="number"&&t.height&&(p=`${t.height}px`),p}),h=at(cn),f=at(Ti),{d3Module:c,createModule:u,eventHandler:g,debounceRender:d}=Oh({D3Module:t.module,props:t,listenersKeys:r});return Wr(()=>{u(s.value),g((p,m)=>{e(p,m)}),setTimeout(()=>{if(h.value=a.value.clientWidth,f.value=a.value.clientHeight,t.forceFit){const p=Uh(a.value);K(p,()=>{h.value=p.value.width,f.value=p.value.height,c.value.resize&&c.value.resize({width:h.value,height:f.value}),d(),e("resize",{width:h.value,height:f.value})})}else d();K(t,()=>d()),K(()=>[t.width,t.height],()=>{e("resize",{width:t.width,height:t.height})})})}),{d3Module:c,container:a,svg:s,containerWidth:o,containerHeight:l,svgWidth:h,svgHeight:f}}}),Nr=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},qh=["width","height"];function Kh(t,e,n,i,r,a){return pe(),me("div",{ref:"container",style:Vr([{position:"relative"},{width:t.containerWidth,height:t.containerHeight}])},[(pe(),me("svg",{ref:"svg","xmlns:xlink":"http://www.w3.org/1999/xlink",xmls:"http://www.w3.org/2000/svg",version:"1.1",style:{position:"absolute"},width:t.svgWidth,height:t.svgHeight},null,8,qh))],4)}const Er=Nr(Vh,[["render",Kh]]),P=["#67B7DC","#6794DC","#6771DC","#8067DC","#A367DC","#C767DC","#DC67CE","#DC67AB","#DC6788","#DC6967","#DC8C67","#DCAF67"],Pe=800,Ne=500,nt={top:50,right:70,bottom:50,left:70},On="#e1e1e1",ht="#7b7b7b",Un={offsetX:20,offsetY:5,type:"white",templateHtml:()=>""},Zh={...Un,templateHtml:()=>"",yLine:void 0,alignCenter:void 0};({...Un});class Yr{constructor(e,n){this.params=Un,this.datum={x:-1,y:-1,data:null},this.renderData={_sourceData:{x:-1,y:-1},x:-1,y:-1,contentHtml:""},this.setTooltipStyle=i=>{},this.render=()=>{this.renderTooltip([this.renderData])},this.selection=e,this.params={...this.params,...n},this.params.type==="black"?this.setTooltipStyle=i=>{i.style("pointer-events","none").style("white-space","nowrap").style("padding","10px 10px").style("background","#333333").style("border-radius","5px").style("opacity",.9).style("color","white").style("font-size","14px").style("text-align","left")}:this.params.type==="white"&&(this.setTooltipStyle=i=>{i.style("pointer-events","none").style("white-space","nowrap").style("padding","10px 15px").style("background-color","rgba(255,255,255,.8)").style("border","1px solid rgba(152,152,152,0.5)").style("border-radius","5px").style("color","black").style("font-size","12px").style("line-height","20px").style("text-align","left")})}setDatum(e){if(e!=null&&e.data&&(this.datum.data=e.data,this.renderData.contentHtml=this.params.templateHtml?this.params.templateHtml(e.data):""),!this.renderData.contentHtml)return;const n=(e==null?void 0:e.x)??_.clientX,i=(e==null?void 0:e.y)??_.clientY;this.datum.x=n,this.datum.y=i,this.renderData.x=n,this.renderData.y=i,this.render()}select(){return this.selection}}function Qh(t){var i;const e=document.createElementNS("http://www.w3.org/1999/xhtml","div");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t+"</svg>";const n=document.createDocumentFragment();for(;n&&((i=e==null?void 0:e.firstChild)!=null&&i.firstChild);)n.appendChild(e.firstChild.firstChild);return n}function Jh(t,e){const n=t.node();for(;n.hasChildNodes();)n.removeChild(n.firstChild);t.node().appendChild(Qh(e))}function jh(t,{text:e,radius:n,lineHeight:i,isBreakAll:r=!1,limit:a=0}){if(t==null||e==null){console.error("selection or text is not defined");return}n==null&&(n=t.node().getBBox().width/2);function s(g){let d;return r?d=g.split(""):d=g.split(/\s+/g),d[d.length-1]||d.pop(),d[0]||d.shift(),d}function o(g,d){return g&&d&&g.length>d&&(g=g.substring(0,d)+"..."),g}function l(g){var p;const d=document.createElement("canvas").getContext("2d");return((p=d==null?void 0:d.measureText(g))==null?void 0:p.width)??0}function h(g){const d=l(g.trim());return Math.sqrt(d*i)}function f(g,d){let p={width:0,text:""},m=1/0;const y=[];let b=" ";r&&(b="");for(let v=0,x=g.length;v<x;++v){const M=(p.text?p.text+b:"")+g[v],k=l(M);(m+k)/2<d?(p.width=m=k,p.text=M):(m=l(g[v]),p={width:m,text:g[v]},y.push(p))}return y}function c(g){let d=0;for(let p=0,m=g.length;p<m;++p){const y=(Math.abs(p-m/2+.5)+.5)*i,b=g[p].width/2;d=Math.max(d,Math.sqrt(b**2+y**2))}return d}function u(g,d){a>0&&(d=o(d,a));const p=s(d),m=h(d),y=f(p,m),b=c(y);let v=g.select("text");v.size()||(v=g.append("text")),v.attr("transform",`translate(0,0) scale(${n/b})`);const x=v.selectAll("tspan").data(y);return x.enter().append("tspan").attr("x",0).merge(x).attr("y",(M,k)=>(k-y.length/2+.8)*i).text(M=>M.text),x.exit().remove(),g.node()}u(t,e)}function Ee(t){try{return t.node().getBoundingClientRect()}catch(e){throw new Error(e)}}const tu=(t,e)=>e instanceof Function?e(t):Xn(e)(t);class eu extends Yr{constructor(e,n){super(e,n),this.tooltipSelection=void 0,this.setParams(n??this.params)}setParams(e){this.params={...this.params,...e},((e==null?void 0:e.insideBoxMode)??!0)===!0?this.renderTooltip=this.renderInsideBox:this.renderTooltip=this.renderDefault}renderDefault(e){try{this.tooltipSelection.interrupt("fadeout")}catch{}const n=I("body").selectAll(".bpchat___tooltip").data(e),i=n.enter().append("div").classed("bpchat___tooltip",!0).call(this.setTooltipStyle);this.tooltipSelection=n.merge(i).style("position","fixed").style("z-index",1e4).style("left",r=>`${r.x+this.params.offsetX}px`).style("top",r=>`${r.y+this.params.offsetY}px`).html(r=>r.contentHtml).on("interrupt",(r,a,s)=>{I(s[a]).style("opacity",1)}),n.exit().transition("fadeout").style("opacity",0).remove().on("interrupt",(r,a,s)=>{I(s[a]).style("opacity",1)})}renderInsideBox(e){var f;try{this.tooltipSelection.interrupt("fadeout")}catch{}const n=Ee(this.selection),i=(f=this.tooltipSelection)!=null&&f.node()?Ee(this.tooltipSelection):{width:0,height:0},r=n.x,a=n.x+n.width-i.width,s=n.y,o=n.y+n.height-i.height,l=I("body").selectAll(".bpchat___tooltip").data(e),h=l.enter().append("div").classed("bpchat___tooltip",!0).call(this.setTooltipStyle);this.tooltipSelection=l.merge(h).style("position","fixed").style("z-index",1e4).style("left",c=>{const u=c.x+this.params.offsetX;return u<r?`${r}px`:u>a?`${a}px`:`${u}px`}).style("top",c=>{const u=c.y+this.params.offsetY;return u<s?`${s}px`:u>o?`${o}px`:`${u}px`}).html(c=>c.contentHtml),l.exit().transition("fadeout").style("opacity",0).remove().on("interrupt",(c,u,g)=>{I(g[u]).style("opacity",1)})}renderTooltip(e){}remove(){this.tooltipSelection&&this.tooltipSelection.transition("fadeout").style("opacity",0).remove().on("interrupt",(e,n,i)=>{I(i[n]).style("opacity",1)})}}const nu={colors:P,outerRadius:.95,innerRadius:0,outerMouseoverRadius:1,enterDuration:800,startAngle:0,endAngle:Math.PI*2,padAngle:.02,cornerRadius:0,highlightTarget:"item",highlightDatumId:"",highlightItemId:""},Kt=(t,e)=>t-e.left-e.right,Zt=(t,e)=>t-e.top-e.bottom,iu=({axisLabels:t,axisWidth:e,padding:n=.5,reverse:i=!1})=>{let r=[0,e];return i&&(r=[e,0]),kr().domain(t).range(r).padding(.5)},ru=({maxValue:t,minValue:e,axisWidth:n,domainMinValue:i=void 0,domainMaxValue:r=void 0,domainMinRange:a=void 0,domainMaxRange:s=void 0,reverse:o=!1})=>{let l=e,h=t;if(i!=null){const c=i;l=c<l?c:l}if(a!=null){const c=t-(t-e)/(1-a);l=c<l?c:l}if(r!=null){const c=r;h=c>h?c:h}if(s!=null){const c=t/s;h=c>h?c:h}l==0&&h==0&&(h=1);let f=[l,h];return o&&(f=[h,l]),Oe().domain(f).range([0,n])},au=({axisLabels:t,axisWidth:e,reverse:n=!1})=>{let r=[];return n?r=t.map((a,s)=>t.length-1-s):r=t.map((a,s)=>s),Sr().domain([-0,e+0]).range(r)},su=(t,e)=>Ge().domain(t.map(n=>n)).range(t.map((n,i)=>e[i])),ic=({axisWidth:t,innerRadius:e,outerRadius:n,padAngle:i,cornerRadius:r})=>{const a=Oe().domain([0,1]).range([0,t/2]),s=a(n);return kh().innerRadius(a(e)).outerRadius(s).padAngle(i).padRadius(s).cornerRadius(r)},ou={solidColor:void 0,colors:P,outerRadius:1,enterDuration:800,startAngle:0,endAngle:Math.PI*2,centroid:2.3,fontSize:12,text:t=>String(t.value),highlightTarget:"item",highlightDatumId:"",highlightItemId:""},lu={padding:nt,tooltipFollowing:{templateHtml:t=>`
      <div>
        <div>${t.datum.data.arcLabel}</div>
        <div>${t.datum.value}</div>
      </div>
    `}},rc={...lu,graphicArcPie:nu,labelArcPie:ou,startAngle:0,endAngle:Math.PI*2,colors:P,enterDuration:800,highlightTarget:"datum",highlightDatumId:"",highlightItemId:"",centerText:(t,e,n)=>[],centerTextAttrs:[],centerTextStyles:[]};class hu extends Yr{constructor(e,n){super(e,n),this.params=Zh,this.tooltipSelection=void 0,this.lineSelection=void 0,this.containerSize={height:0,width:0,x:0,y:0},this.setParams(n??this.params)}setParams(e){this.params={...this.params,...e}}doRenderTooltip(e){try{this.tooltipSelection.interrupt("fadeout")}catch{}const n=this.tooltipSelection&&this.tooltipSelection.node()?Ee(this.tooltipSelection):{width:0,height:0},i=this.containerSize.x+this.containerSize.width-n.width,r=this.containerSize.y+this.containerSize.height-n.height,a=l=>{l.style("left",h=>h.x<i?`${h.x+20}px`:`${h.x-n.width-20}px`).style("top",h=>this.params.alignCenter?this.containerSize.y+this.containerSize.height/2-n.height/2:h.y<r?`${h.y}px`:`${r+5}px`)},s=I("body").selectAll(".bpchat___tooltip").data(e);s.transition().duration(50).call(a).on("interrupt",(l,h,f)=>{I(f[h]).style("opacity",1)});const o=s.enter().append("div").classed("bpchat___tooltip",!0).call(this.setTooltipStyle);o.call(a),this.tooltipSelection=s.merge(o),this.tooltipSelection.style("position","fixed").style("z-index",1e4).html(l=>l.contentHtml),s.exit().transition("fadeout").style("opacity",0).remove().on("interrupt",(l,h,f)=>{I(f[h]).style("opacity",1)})}renderYLine(e){const n=e[0]?e[0].x-this.containerSize.x:0,i=this.selection.selectAll(".bpchart__tooltip__line").data(e),r=i.enter().append("line").classed("bpchart__tooltip__line",!0).style("stroke","#E4E7ED").style("stroke-width",1).style("pointer-events","none");this.lineSelection=i.merge(r).attr("x1",n).attr("y1",0).attr("x2",n).attr("y2",this.containerSize.height),i.exit().transition("fadeout").style("opacity",0).remove().on("interrupt",(a,s,o)=>{I(o[s]).style("opacity",1)})}renderTooltip(e){this.containerSize=Ee(this.selection),this.params.yLine==!0&&this.renderYLine(e),this.doRenderTooltip(e)}remove(){this.tooltipSelection&&this.tooltipSelection.transition("fadeout").style("opacity",0).remove().on("end",()=>{var e;this.params.yLine==!0&&((e=this.lineSelection)==null||e.remove())}),this.renderData.contentHtml=""}}class uu{constructor(e){this.data=[],this.auxLineSelection=void 0,this.selection=e}setData(e){this.data=e}render(){const e=this.selection.selectAll("line.bpchart__auxline").data(this.data),n=e.enter().append("line").classed("bpchart__auxline",!0).style("stroke",ht).style("stroke-width",1).style("stroke-dasharray","3,3").style("pointer-events","none");this.auxLineSelection=e.merge(n).attr("opacity",i=>i.active==!0?1:0),e.exit().remove(),n.attr("x1",i=>i.x1).attr("y1",i=>i.y1).attr("x2",i=>i.x2).attr("y2",i=>i.y2),e.transition().duration(50).attr("x1",i=>i.x1).attr("y1",i=>i.y1).attr("x2",i=>i.x2).attr("y2",i=>i.y2)}remove(){this.selection.remove()}}const cu={xLabel:"x",y1Label:"y1",y2Label:"y2",xLabelAnchor:"start",y1LabelAnchor:"end",y2LabelAnchor:"start",xLabelOffset:[0,0],y1LabelOffset:[0,0],y2LabelOffset:[0,0],y1LabelColor:ht,y2LabelColor:ht,y1TickFormat:",.0f",y2TickFormat:",.0f",xTickPadding:20,y1TickPadding:20,y2TickPadding:20,xTickLine:!1,y1TickLine:1,y2TickLine:1,xTickLineDasharray:"none",y1TickLineDasharray:"none",y2TickLineDasharray:"4",y1Ticks:4,y2Ticks:4,axisLineColor:On,axisLabelColor:ht,rotateXLabel:!1,padding:nt,xVisible:!0,y1Visible:!0,y2Visible:!0},jt={lineType:"line",lineCurve:"curveLinear",colors:P,highlightTarget:"item",highlightItemId:"",enterDuration:800,labelTextMethod:(t,e)=>"",labelPositionMethod:(t,e)=>"top",labelStyleMethod:(t,e)=>"",labelFontSizeMethod:(t,e)=>10,labelColorMethod:(t,e)=>ht,labelPadding:15},fu={barDirection:"right",positionPadding:5};function Br(t,e=10){var r;const n=document.createElement("canvas").getContext("2d");return(((r=n==null?void 0:n.measureText(t))==null?void 0:r.width)??0)*e/10}const du=(t,e)=>{const n=t.map(s=>{const o=Br(s.text,s.fontSize)+2,l=s.fontSize;let h=0,f=0,c="middle",u="central",g=0,d=0,p=0,m=0;return s.position==="left"?(h=s.barX0-e.positionPadding,f=(s.barY0+s.barY1)/2,c="end",u="central",g=h-o,d=h,p=f-l/2,m=f+l/2):s.position==="right"?(h=s.barX1+e.positionPadding,f=(s.barY0+s.barY1)/2,c="start",u="central",g=h,d=h+o,p=f-l/2,m=f+l/2):s.position==="top"?(h=(s.barX0+s.barX1)/2,f=s.barY0-e.positionPadding,c="middle",u="auto",g=h-o/2,d=h+o/2,p=f-l,m=f):s.position==="bottom"?(h=(s.barX0+s.barX1)/2,f=s.barY1+e.positionPadding,c="middle",u="hanging",g=h-o/2,d=h+o/2,p=f,m=f+l):s.position==="center"&&(h=(s.barX0+s.barX1)/2,f=(s.barY0+s.barY1)/2,c="middle",u="central",g=h-o/2,d=h+o/2,p=f,m=f+l),{...s,width:o,height:l,boundaryX0:g,boundaryX1:d,boundaryY0:p,boundaryY1:m,positionX:h,positionY:f,textAnchor:c,dominantBaseline:u,renderX:0,renderY:0,offsetX:0,offsetY:0}}),i=Object.assign([],n).sort((s,o)=>e.barDirection==="left"?o.positionX-s.positionX:e.barDirection==="right"?s.positionX-o.positionX:e.barDirection==="up"?o.positionY-s.positionY:e.barDirection==="down"?s.positionY-o.positionY:s.positionX-o.positionX),r=(s,o)=>o.filter(l=>(l.boundaryX0>=s.boundaryX0&&l.boundaryX0<=s.boundaryX1||l.boundaryX1>=s.boundaryX0&&l.boundaryX1<=s.boundaryX1)&&(l.boundaryY0>=s.boundaryY0&&l.boundaryY0<=s.boundaryY1||l.boundaryY1>=s.boundaryY0&&l.boundaryY1<=s.boundaryY1)),a=[];return i.forEach(s=>{let o=s.positionX,l=s.positionY;const h=r(s,a);let f=0,c=0;h.length&&(e.barDirection==="left"?f=h.reduce((y,b)=>b.boundaryX0<y?b.boundaryX0:y,1/0)-s.boundaryX1:e.barDirection==="right"?f=h.reduce((y,b)=>b.boundaryX1>y?b.boundaryX1:y,-1/0)-s.boundaryX0:e.barDirection==="up"?c=h.reduce((y,b)=>b.boundaryY0<y?b.boundaryY0:y,1/0)-s.boundaryY1:e.barDirection==="down"&&(c=h.reduce((y,b)=>b.boundaryY1>y?b.boundaryY1:y,1/0)-s.boundaryY0));let u=0,g=0;e.barDirection==="left"&&(s.position==="top"||s.position==="bottom"||s.position==="center")&&s.boundaryX1>s.barX1?u=s.barX1-s.boundaryX1:e.barDirection==="right"&&(s.position==="top"||s.position==="bottom"||s.position==="center")&&s.boundaryX0<s.barX0?u=s.barX0-s.boundaryX0:e.barDirection==="up"&&(s.position==="left"||s.position==="right"||s.position==="center")&&s.boundaryY1>s.barY1?g=s.barY1-s.boundaryY1:e.barDirection==="down"&&(s.position==="left"||s.position==="right"||s.position==="center")&&s.boundaryY0<s.barY0&&(g=s.barY0-s.boundaryY0);const d=Math.abs(f)>Math.abs(u)?f:u,p=Math.abs(c)>Math.abs(g)?c:g;a.push({...s,boundaryX0:s.boundaryX0+d,boundaryX1:s.boundaryX1+d,boundaryY0:s.boundaryY0+p,boundaryY1:s.boundaryY1+p,renderX:o,renderY:l,offsetX:d,offsetY:p})}),a};class gu{constructor(e,n){this.data=[],this.params=fu,this.renderData=[],this.selection=e,this.labelGSelection=this.selection.append("g").style("pointer-events","none")}remove(){this.selection.remove()}setParams(e){this.params={...this.params,...e}}setData(e){this.data=e,this.renderData=du(e,this.params)}render(){const e=this.labelGSelection.selectAll("text").data(this.renderData),n=e.enter().append("text");e.exit().remove(),this.labelSelection=e.merge(n).attr("text-anchor",i=>i.textAnchor).attr("dominant-baseline",i=>i.dominantBaseline).attr("font-size",(i,r)=>i.fontSize).attr("fill",(i,r)=>i.color).attr("style",i=>i.style).text(i=>i.text),n.attr("x",i=>this.params.barDirection==="left"||this.params.barDirection==="right"?0:i.positionX).attr("y",i=>this.params.barDirection==="left"||this.params.barDirection==="right"?i.positionY:0).attr("transform",(i,r)=>this.params.barDirection==="left"||this.params.barDirection==="right"?`translate(0, ${i.offsetY})`:`translate(${i.offsetX}, 0)`),this.labelSelection.transition().duration(200).attr("x",i=>i.positionX).attr("y",i=>i.positionY).attr("transform",(i,r)=>`translate(${i.offsetX}, ${i.offsetY})`)}}const Rt={r:4,fill:"#fff",strokeWidth:2,colors:P,highlightTarget:"item",highlightItemId:"",highlightDatumId:"",enterDuration:20},Hr={barType:"rect",barWidth:0,barPadding:1,barR:!1,colors:P,highlightTarget:"datum",highlightDatumId:"",enterDuration:800},$r={barType:"rect",barWidth:0,barPadding:1,barGroupPadding:20,barR:!1,colors:P,highlightTarget:"item",highlightGroupId:"",highlightItemId:"",highlightDatumId:"",enterDuration:800},Xr={barWidth:0,barGroupPadding:1,barR:!1,colors:P,highlightTarget:"item",highlightGroupId:"",highlightItemId:"",highlightDatumId:"",enterDuration:800},pu=P.map(t=>t).reverse(),We={axisColumnTwoScales:cu,tooltipAside:{templateHtml:t=>t.y1.groupData&&t.y2.groupData?`
          <div>
            <div>${t.xLabel}</div>
            <div>${t.y1.groupData.map(e=>e.value).join(",")}</div>          
            <div>${t.y2.groupData.map(e=>e.value).join(",")}</div>          
          </div>
        `:""},y1Colors:P,y2Colors:pu,padding:nt,highlightTarget:"datum",highlightDatumId:"",highlightItemId:"",highlightGroupId:"",showAuxLine:!1,y1DomainMinValue:0,y1DomainMaxValue:void 0,y1DomainMinRange:void 0,y1DomainMaxRange:.95,y2DomainMinValue:0,y2DomainMaxValue:void 0,y2DomainMinRange:void 0,y2DomainMaxRange:.95,showDot:"hover"};({...We});const ac={...We,graphicColumnLine:jt,graphicDot:Rt,graphicColumnBarGroup:$r};({...We});({...We});const zr={xLabel:"x",yLabel:"y",xLabelAnchor:"start",yLabelAnchor:"end",xLabelOffset:[0,0],yLabelOffset:[0,0],xTickPadding:20,yTickPadding:20,xTickLine:!0,yTickLine:!1,xTickLineDasharray:"none",yTickLineDasharray:"none",xTickFormat:",.0f",xTicks:4,axisLineColor:On,axisLabelColor:ht,rotateYLabel:!1,padding:nt,xVisible:!0,yVisible:!0,yLabelIconMethod:void 0},oe=6;class mu{constructor(e,n){this.width=Pe,this.height=Ne,this.dataset={xScale:Oe(),yScale:kr(),maxValue:0},this.params=zr,this.xAxisSelection=void 0,this.yAxisSelection=void 0,this.xLabelSelection=void 0,this.yLabelSelection=void 0,this.axisWidth=Kt(this.width,nt),this.axisHeight=Zt(this.height,nt),this.selection=e}setParams(e){this.params={...this.params,...e}}setDataset(e){this.dataset=e}resize({width:e=this.width,height:n=this.height}){this.width=e,this.height=n,this.axisWidth=Kt(this.width,this.params.padding),this.axisHeight=Zt(this.height,this.params.padding)}render(){this.renderYPointAxis(),this.renderXLinearAxis();const e=this.dataset.xScale(0);this.renderZeroLine(this.selection,[{x1:e,y1:0,x2:e,y2:this.axisHeight}])}remove(){this.selection.remove()}renderYPointAxis(){let e=[];this.params.yVisible&&e.push(this.params);const n=this.selection.selectAll("g.yAxis").data(e),i=n.enter().append("g");this.yAxisSelection=n.merge(i).classed("yAxis",!0).attr("transform",l=>"translate("+l.padding.left+","+l.padding.top+")"),n.exit().remove();const r=this.selection.selectAll("text.yLabel").data(e),a=r.enter().append("text").classed("yLabel",!0).style("font-size","14px").style("font-weight","bold");if(this.yLabelSelection=r.merge(a).attr("x",l=>l.padding.left-l.xTickPadding-oe).attr("y",l=>l.padding.top-l.yTickPadding).attr("text-anchor",this.params.yLabelAnchor).attr("transform",`translate(${this.params.yLabelOffset[0]}, ${this.params.yLabelOffset[1]})`).style("fill",this.params.axisLabelColor).text(l=>l.yLabel),r.exit().remove(),this.yLabelSelection.size()==0)return;this.yAxis=oa(this.dataset.yScale).scale(this.dataset.yScale).tickSize(this.params.yTickLine&&typeof this.params.yTickLine=="boolean"?-this.axisWidth:this.params.yTickLine&&typeof this.params.yTickLine=="number"?-this.axisWidth*this.params.yTickLine:oe).tickSizeOuter(0).tickFormat(l=>l).tickPadding(this.params.yTickPadding);const s=this.yAxisSelection.transition().duration(50).call(this.yAxis).attr("text-anchor",()=>(this.params.rotateYLabel!==!1,"end"));s.selectAll("line").style("fill","none").style("stroke",this.params.axisLineColor).style("stroke-dasharray",this.params.yTickLineDasharray),s.selectAll("path").style("fill","none").style("stroke",this.params.axisLineColor).style("shape-rendering","crispEdges");const o=s.selectAll("text").style("font-family","sans-serif").style("font-size","14px").style("color",this.params.axisLabelColor).attr("transform-origin",`-5 ${this.params.xTickPadding+oe}`);this.params.rotateYLabel===!0?o.attr("transform","translate(0,0) rotate(-45)"):typeof this.params.rotateYLabel=="number"&&o.attr("transform",`translate(0,0) rotate(${this.params.rotateYLabel})`),this.appendLabelIcon(this.yAxisSelection.selectAll("g.tick"),this.params.yLabelIconMethod)}appendLabelIcon(e,n){e.each((i,r,a)=>{const s=I(a[r]),o=s.select("text"),l=o.data(),h=Math.abs(Number(o.attr("x"))),f=Br(l,14),c=-h-f-21,u=-7,g=s.selectAll("g.bpchart__icon").data([l]),d=g.enter().append("g").classed("bpchart__icon",!0);g.exit().remove(),d.size()&&n&&(console.log("enter.size()",d.size()),Jh(d,n(l,r))),g.merge(d).attr("transform",`translate(${c}, ${u})`)})}renderXLinearAxis(){let e=[];this.params.xVisible&&e.push(this.params);const n=this.selection.selectAll("g.xAxis").data(e),i=n.enter().append("g");this.xAxisSelection=n.merge(i).classed("xAxis",!0).attr("transform",o=>"translate("+o.padding.left+","+(o.padding.top+this.axisHeight)+")"),n.exit().remove();const r=this.selection.selectAll("text.xLabel").data(e),a=r.enter().append("text").classed("xLabel",!0).style("font-size","14px").style("font-weight","bold").style("fill",this.params.axisLabelColor).style("dominant-baseline","hanging");if(this.xLabelSelection=r.merge(a).attr("x",o=>this.width-o.padding.right+o.xTickPadding).attr("y",o=>o.padding.top+this.axisHeight+o.yTickPadding).attr("transform",`translate(${this.params.xLabelOffset[0]}, ${this.params.xLabelOffset[1]})`).attr("text-anchor",this.params.xLabelAnchor).text(o=>o.xLabel),r.exit().remove(),this.xLabelSelection.size()==0)return;this.xAxis=sa(this.dataset.xScale).scale(this.dataset.xScale).ticks(this.dataset.maxValue>this.params.xTicks?this.params.xTicks:this.dataset.maxValue===0?1:Math.ceil(this.dataset.maxValue)).tickFormat(o=>tu(o,this.params.xTickFormat)).tickSize(this.params.xTickLine&&typeof this.params.xTickLine=="boolean"?-this.axisHeight:this.params.xTickLine&&typeof this.params.xTickLine=="number"?-this.axisHeight*this.params.xTickLine:oe).tickPadding(this.params.xTickPadding);const s=this.xAxisSelection.transition().duration(100).call(this.xAxis);s.selectAll("line").style("fill","none").style("stroke",this.params.axisLineColor).style("stroke-dasharray",this.params.xTickLineDasharray),s.selectAll("path").style("fill","none").style("stroke","none").style("shape-rendering","crispEdges"),s.selectAll("text").style("font-family","sans-serif").style("font-size","14px").style("color",this.params.axisLabelColor)}renderZeroLine(e,n){const i=e.selectAll("g.bpchart__zero-line").data(n),r=i.enter().append("g").classed("bpchart__zero-line",!0).attr("transform",s=>"translate("+this.params.padding.left+","+this.params.padding.top+")");i.exit().remove();const a=i.merge(r);r.append("line"),a.select("line").attr("stroke",this.params.axisLabelColor).attr("stroke-width",1).transition().duration(100).attr("x1",s=>s.x1).attr("y1",s=>s.y1).attr("x2",s=>s.x2).attr("y2",s=>s.y2).attr("opacity",s=>s.x1>=0&&s.x1<=this.axisWidth?1:0)}}const yu={barWidth:0,barPadding:1,barR:!1,colors:P,highlightTarget:"datum",highlightDatumId:"",enterDuration:800},vu={barWidth:0,barPadding:1,barGroupPadding:20,barR:!1,colors:P,highlightTarget:"item",highlightGroupId:"",highlightItemId:"",highlightDatumId:"",enterDuration:800},xu={barWidth:0,barGroupPadding:20,barR:!1,colors:P,highlightTarget:"item",highlightGroupId:"",highlightItemId:"",highlightDatumId:"",enterDuration:800},Fr={groupLayout:[],barPadding:1,barGroupPadding:20,colors:P,highlightTarget:"item",highlightGroupId:"",highlightItemId:"",highlightDatumId:"",enterDuration:800,labelTextMethod:(t,e)=>String(t.value),labelPositionMethod:(t,e)=>"top",labelStyleMethod:(t,e)=>"",labelFontSizeMethod:(t,e)=>10,labelColorMethod:(t,e)=>ht,labelPadding:5},bu=(t,e)=>{const n=new Map;return e.forEach((i,r)=>{n.set(i,t[r])}),n},_u=(t,e)=>{const n=new Map;return t.forEach((i,r)=>{i.forEach((a,s)=>{const o=n.get(e[s])??[];o.push(a),n.set(e[s],o)})}),n},wu=({groupLayout:t,yLabels:e,itemLabels:n,axisHeight:i,barPadding:r,barGroupPadding:a})=>{if(!t.length)return[{stackAmount:n.length,barWidth:Ii({axisHeight:i,groupAmount:e.length,barAmountOfGroup:1,barPadding:r,barGroupPadding:a}),barR:!1,datumIndexList:n.map((c,u)=>u)}];const s=t.reduce((c,u)=>{let g=0;return u.barWidth&&(g=u.barWidth+r),c+g},0),o=t.reduce((c,u)=>c+(u.barWidth?1:0),0),l=s*e.length,h=Ii({axisHeight:i-l,groupAmount:e.length,barAmountOfGroup:t.length-o,barPadding:r,barGroupPadding:a});let f=-1;return t.map((c,u)=>{const g=c.stackAmount??1;let d=[];f+=1;for(let p=f;p<f+g;p++)d.push(p);return f=d[d.length-1],{stackAmount:g,barWidth:c.barWidth??h,barR:c.barR??!1,datumIndexList:d}})},Au=({YDataMap:t,yLabels:e,axisHeight:n,groupLayout:i,barGroupPadding:r,barPadding:a})=>{let s=0;return i.every(o=>o.barWidth)?(s=i.reduce((o,l)=>o+l.barWidth,0),s+=a*(i.length-1)):s=Gr({axisHeight:n,groupAmount:e.length,barGroupPadding:r}),e.map((o,l)=>{const h=t.get(o)??[];let f=[],c=-s/2;return i.forEach((u,g)=>{let d=0;const p=c;u.datumIndexList.forEach(m=>{const y=h[m];f.push({...y,sourceIndex:[m,l],barX:d,barY:p+u.barWidth/2,groupY:y.y,barWidth:u.barWidth,barR:u.barR==!0?u.barWidth/2:typeof u.barR=="number"?u.barR:0,width:y.x}),d+=y.x}),c+=u.barWidth+a}),f})},Mu=(t,e)=>{let n=[];return t.forEach((i,r)=>{i.forEach((a,s)=>{n.push({id:a.id,data:a,barX0:a.barX,barX1:a.barX+a.width,barY0:a.groupY+a.barY-a.barWidth/2,barY1:a.groupY+a.barY+a.barWidth/2,position:e.labelPositionMethod(a,a.sourceIndex),fontSize:e.labelFontSizeMethod(a,a.sourceIndex),color:e.labelColorMethod(a,a.sourceIndex),style:e.labelStyleMethod(a,a.sourceIndex),text:e.labelTextMethod(a,a.sourceIndex)})})}),n},le=({datum:t,YDataMap:e,ItemDataMap:n,event:i})=>({groupData:e.get(t.yLabel),itemData:n.get(t.itemLabel),datum:t,yLabel:t.yLabel,yIndex:t.yIndex,itemLabel:t.itemLabel,itemIndex:t.itemIndex,clientX:i.clientX,clientY:i.clientY,offsetX:i.offsetX,offsetY:i.offsetY}),Gr=({axisHeight:t,groupAmount:e,barGroupPadding:n=0})=>{const i=t/e-n;return i>1?i:1},Ii=({axisHeight:t,groupAmount:e,barAmountOfGroup:n,barPadding:i=0,barGroupPadding:r=0})=>{const s=Gr({axisHeight:t,groupAmount:e,barGroupPadding:r})/n-i;return s>1?s:1},ku=(t,e=400)=>e/t;class Lu{constructor(e,n){this.params=Fr,this.dataset={data:[],itemLabels:[],yLabels:[],axisHeight:0,zeroX:0},this.graphicData=[],this.groupLayout=[],this.graphicGroupSelection=void 0,this.graphicBarSelection=void 0,this.itemLabels=[],this.ItemDataMap=new Map,this.YDataMap=new Map,this.axisHeight=0,this.delayDuration=0,this.clickCallback=function(){},this.mouseoverCallback=function(){},this.mousemoveCallback=function(){},this.mouseoutCallback=function(){},this.selection=e,this.graphicBoxSelection=this.selection.append("g"),this.labelBoxSelection=this.selection.append("g"),this.defsSelection=this.selection.append("defs"),this.utilGraphicBarLabel=new gu(this.labelBoxSelection,{})}setParams(e){this.params={...this.params,...e},this.itemLabels=[],this.utilGraphicBarLabel.setParams({barDirection:"right",positionPadding:this.params.labelPadding})}setDataset(e){this.dataset=e,this.itemLabels=this.dataset.itemLabels,this.ItemDataMap=bu(this.dataset.data,this.dataset.itemLabels),this.YDataMap=_u(this.dataset.data,this.dataset.yLabels),this.delayDuration=ku(this.dataset.yLabels.length)}render(){this.itemLabels.length&&(this.colorScale=su(this.itemLabels,this.params.colors),this.axisHeight=this.dataset.axisHeight,this.groupLayout=wu({groupLayout:this.params.groupLayout,yLabels:this.dataset.yLabels,itemLabels:this.dataset.itemLabels,axisHeight:this.axisHeight,barPadding:this.params.barPadding,barGroupPadding:this.params.barGroupPadding}),this.graphicData=Au({YDataMap:this.YDataMap,yLabels:this.dataset.yLabels,axisHeight:this.axisHeight,groupLayout:this.groupLayout,barPadding:this.params.barPadding,barGroupPadding:this.params.barGroupPadding}),this.renderGraphic({selection:this.graphicBoxSelection,graphicData:this.graphicData,yLabels:this.dataset.yLabels,colorScale:this.colorScale,params:this.params}),this.graphicBarSelection.on("click",(e,n)=>{const i=le({datum:e,YDataMap:this.YDataMap,ItemDataMap:this.ItemDataMap,event:_});this.clickCallback(i)}).on("mouseover",(e,n,i)=>{const r=le({datum:e,YDataMap:this.YDataMap,ItemDataMap:this.ItemDataMap,event:_});this.params.highlightTarget!=null&&this.params.highlightTarget!="none"&&(this.params.highlightTarget==="group"?this.highlight(this.graphicBarSelection,r.yLabel,void 0,void 0):this.params.highlightTarget==="item"?this.highlight(this.graphicBarSelection,void 0,r.itemLabel,void 0):this.params.highlightTarget==="datum"&&this.highlight(this.graphicBarSelection,void 0,void 0,r.datum&&r.datum.id)),this.mouseoverCallback(r)}).on("mousemove",(e,n)=>{const i=le({datum:e,YDataMap:this.YDataMap,ItemDataMap:this.ItemDataMap,event:_});this.mousemoveCallback(i)}).on("mouseout",(e,n)=>{this.params.highlightTarget!=null&&this.params.highlightTarget!="none"&&this.removeHighlight(this.graphicBarSelection);const i=le({datum:e,YDataMap:this.YDataMap,ItemDataMap:this.ItemDataMap,event:_});this.initHighlight(),this.mouseoutCallback(i)}),this.utilGraphicBarLabel.setData(Mu(this.graphicData,this.params)),this.utilGraphicBarLabel.render())}on(e,n){return e==="click"?this.clickCallback=n:e==="mouseover"?this.mouseoverCallback=n:e==="mousemove"?this.mousemoveCallback=n:e==="mouseout"&&(this.mouseoutCallback=n),this}remove(){this.selection.remove()}renderGraphic({selection:e,graphicData:n,yLabels:i,colorScale:r,params:a}){const s=e.selectAll("g.bpchart__bar-g").data(n,(l,h)=>i[h]),o=s.enter().append("g").classed("bpchart__bar-g",!0).attr("cursor","pointer");s.exit().remove(),this.graphicGroupSelection=s.merge(o),o.attr("transform",(l,h)=>`translate(0, ${l[0]?l[0].groupY:0})`),s.transition().duration(200).attr("transform",(l,h)=>`translate(0, ${l[0]?l[0].groupY:0})`),this.graphicGroupSelection.each((l,h,f)=>{const c=I(f[h]).selectAll("g").data(l,d=>d.id),u=c.enter().append("g").classed("bpchart__bar",!0);u.append("rect").attr("rx",d=>d.barR).attr("transform",d=>`translate(0, ${-d.barWidth/2})`).attr("x",this.dataset.zeroX).attr("y",d=>d.barY).attr("width",0).attr("height",d=>d.barWidth),c.merge(u).select("rect").attr("fill",d=>r(d.itemLabel)).transition().duration(this.params.enterDuration).ease(yl).delay((d,p)=>d.yIndex*this.delayDuration).attr("transform",d=>`translate(0, ${-d.barWidth/2})`).attr("x",d=>d.barX).attr("y",d=>d.barY).attr("width",d=>d.width).attr("height",d=>d.barWidth).on("end",()=>this.initHighlight()),c.exit().remove()}),this.graphicBarSelection=this.graphicGroupSelection.selectAll("g.bpchart__bar")}initHighlight(){this.graphicBarSelection&&(this.params.highlightDatumId||this.params.highlightItemId||this.params.highlightGroupId)&&this.highlight(this.graphicBarSelection,this.params.highlightGroupId,this.params.highlightItemId,this.params.highlightDatumId)}highlight(e,n,i,r){if(!e)return;let a=[];if(r&&a.push(r),i){const s=this.dataset.data.flat().filter(o=>o.itemLabel===i).map(o=>o.id);a=a.concat(s)}if(n){const s=this.dataset.data.flat().filter(o=>o.yLabel===n).map(o=>o.id);a=a.concat(s)}e.each((s,o,l)=>{a.includes(s.id)?I(l[o]).transition().duration(200).style("opacity",1):I(l[o]).transition().duration(200).style("opacity",.3)})}removeHighlight(e){this.params.highlightDatumId||this.params.highlightItemId||this.params.highlightGroupId?this.highlight(e,this.params.highlightGroupId,this.params.highlightItemId,this.params.highlightDatumId):e.transition().duration(200).style("opacity",1)}}const Du={barWidth:0,barGroupPadding:1,barR:!1,colors:P,highlightTarget:"item",highlightGroupId:"",highlightItemId:"",highlightDatumId:"",enterDuration:800},Tt={axisRow:zr,tooltipAside:{templateHtml:t=>t.groupData&&t.groupData[0]?`
          <div>
            <div>${t.groupData[0].yLabel}</div>
            <div>${t.groupData.map(e=>e.value).join(",")}</div>          
          </div>
        `:""},colors:P,padding:nt,highlightTarget:"datum",highlightDatumId:"",highlightItemId:"",showAuxLine:!1,domainMinValue:0,domainMaxValue:void 0,domainMinRange:void 0,domainMaxRange:.95};({...Tt});({...Tt});({...Tt});const Su={...Tt,graphicRowBarLayout:Fr},sc={...Tt,graphicRowBarStack:Du},Pi=(t,e)=>({...t,padding:e}),Cu=({dataset:t,activedItemId:e,yDataMap:n,ItemDataMap:i,padding:r,yRangeScale:a,event:s})=>{if(!s||!a)return{dataset:t,groupData:[],itemData:[],datum:void 0,yLabel:"",yIndex:-1,itemLabel:"",itemIndex:-1,rangeIndex:-1,clientX:-1,clientY:-1,offsetX:-1,offsetY:-1};const o=Number(s.offsetY)-r.top,l=Number(a(o)??0),h=t.yLabels[l],f=n.get(h)??[];let c=[],u;return e&&(c=i.get(e)??[],u=f.find(g=>g.itemLabel===e)),{dataset:t,groupData:f,itemData:c,datum:u,yLabel:h,yIndex:l,itemLabel:u?u.itemLabel:"",itemIndex:u?u.itemIndex:-1,rangeIndex:l,clientX:_.clientX,clientY:_.clientY,offsetX:_.offsetX,offsetY:_.offsetY}};class Ru{constructor(e,n){this.width=Pe,this.height=Ne,this.dataset={data:[],yLabels:[]},this.params=Tt,this.graphicSelection=void 0,this.axisWidth=0,this.axisHeight=0,this.clickCallback=function(){},this.mouseoverCallback=function(){},this.mousemoveCallback=function(){},this.mouseoutCallback=function(){},this.yDataMap=new Map,this.ItemDataMap=new Map,this.renderData=[],this.axisParams=this.params.axisRow,this.xAxisSelection=void 0,this.yAxisSelection=void 0,this.xLabelSelection=void 0,this.yLabelSelection=void 0,this.auxLineSelection=void 0,this.minValue=0,this.maxValue=0,this.makeActivedCallbackData=(i,r)=>Cu({dataset:this.dataset,activedItemId:i,yDataMap:this.yDataMap,ItemDataMap:this.ItemDataMap,padding:this.params.padding,yRangeScale:this.yRangeScale,event:r}),this.selection=e,this.axisSelection=e.append("g"),this.axisRow=new mu(this.axisSelection,{}),this.rangeSelection=this.selection.append("rect").attr("opacity",0),this.setRangeEvent(this.rangeSelection),this.graphicSelection=e.append("g"),this.coverSelection=this.selection.append("g").classed("bpchart__cover",!0),this.utilAuxLine=new uu(this.coverSelection),this.setCoverEvent(this.selection)}setParams(e){this.params={...this.params,...e,axisRow:{...this.params.axisRow,...e.axisRow}},this.params.tooltipAside&&!this.tooltip&&(this.tooltip=new hu(this.selection,{templateHtml:this.params.tooltipAside.templateHtml,type:this.params.tooltipAside.type??"white",yLine:this.params.tooltipAside.yLine??!1})),this.axisParams=Pi(this.params.axisRow,this.params.padding),this.axisWidth=Kt(this.width,this.params.padding),this.axisHeight=Zt(this.height,this.params.padding),this.axisRow.setParams(this.axisParams),this.graphicSelection.attr("transform",`translate(${this.params.padding.left}, ${this.params.padding.top})`),this.coverSelection.attr("transform",`translate(${this.params.padding.left}, ${this.params.padding.top})`),this.initGraphic(this.params)}select(){return this.selection}remove(){this.selection.remove()}resize({width:e=this.width,height:n=this.height}){this.width=e,this.height=n,this.axisParams=Pi(this.params.axisRow,this.params.padding),this.axisWidth=Kt(this.width,this.params.padding),this.axisHeight=Zt(this.height,this.params.padding),this.axisRow.setParams(this.axisParams),this.axisRow.resize({width:e,height:n}),this.rangeSelection.attr("x",this.params.padding.left).attr("y",this.params.padding.top).attr("width",this.axisWidth).attr("height",this.axisHeight)}setDataset(e){this.dataset=e;const[n,i]=this.getMinAndMaxValue(this.dataset.data);this.minValue=n,this.maxValue=i}render(){this.yScale=iu({axisLabels:this.dataset.yLabels,axisWidth:this.axisHeight,reverse:!0}),this.xScale=ru({maxValue:this.maxValue,minValue:this.minValue,axisWidth:this.axisWidth,domainMinValue:this.params.domainMinValue,domainMaxValue:this.params.domainMaxValue,domainMinRange:this.params.domainMinRange,domainMaxRange:this.params.domainMaxRange}),this.yRangeScale=au({axisLabels:this.dataset.yLabels,axisWidth:this.axisHeight,reverse:!0}),this.renderData=this.makeGraphicRenderData({dataset:this.dataset,xScale:this.xScale,yScale:this.yScale}),this.yDataMap=this.makeYDataMap({renderData:this.renderData,yLabels:this.dataset.yLabels}),this.ItemDataMap=this.makeItemDataMap({renderData:this.renderData,itemLabels:this.dataset.itemLabels??[]}),this.setGraphicData({renderData:this.renderData,itemLabels:this.dataset.itemLabels??[],yLabels:this.dataset.yLabels,xScale:this.xScale,yScale:this.yScale}),this.axisRow.setDataset({xScale:this.xScale,yScale:this.yScale,maxValue:this.maxValue}),this.axisRow.render(),this.renderGraphic()}on(e,n){return e==="click"?this.clickCallback=n:e==="mouseover"?this.mouseoverCallback=n:e==="mousemove"?this.mousemoveCallback=n:e==="mouseout"&&(this.mouseoutCallback=n),this}setRangeEvent(e){e.on("click",(n,i)=>{const r=this.makeActivedCallbackData("",_);this.clickCallback(r)}).on("mouseover",(n,i)=>{const r=this.makeActivedCallbackData("",_);this.mouseoverCallback(r)}).on("mousemove",n=>{const i=this.makeActivedCallbackData("",_);this.mousemoveCallback(i)}).on("mouseout",n=>{if(_.offsetX>0&&_.offsetX<this.width&&_.offsetY>0&&_.offsetY<this.height)return;const i=this.makeActivedCallbackData("",_);this.mouseoutCallback(i)})}showTooltip(e,n){n&&e&&this.yScale?this.tooltip.setDatum({data:e,x:_.clientX,y:e.clientY-e.offsetY+this.params.padding.top+this.yScale(e.yLabel)}):this.tooltip.remove()}setCoverEvent(e){e.on("mouseover",(n,i)=>{const r=this.makeActivedCallbackData("",_);this.coverHighlight(r),this.showTooltip(r,_)}).on("mousemove",n=>{const i=this.makeActivedCallbackData("",_);this.coverHighlight(i),this.showTooltip(i,_)}).on("mouseout",n=>{_.offsetX>0&&_.offsetX<this.width&&_.offsetY>0&&_.offsetY<this.height||(this.coverHighlight(void 0),this.tooltip.remove())})}coverHighlight(e){this.params.showAuxLine&&this.renderAuxLine({coverSelection:this.coverSelection,yLabels:this.dataset.yLabels,activeRangeIndex:e?e.rangeIndex:-1,yScale:this.yScale,padding:this.params.padding,axisWidth:this.axisWidth}),this.renderGraphicCoverHighlight({eventData:e,xScale:this.xScale,yScale:this.yScale,padding:this.params.padding})}renderAuxLine({coverSelection:e,yLabels:n,activeRangeIndex:i,yScale:r,padding:a,axisWidth:s}){if(!r)return;const o=n.map((l,h)=>{const f=r(l)||0;return{x1:0,x2:s,y1:f,y2:f,active:i==h}});this.utilAuxLine.setData(o),this.utilAuxLine.render()}}const Ni="__DEFAULT__";class Tu extends Ru{constructor(e,n){super(e,n),this.params=Su,this.bar=new Lu(this.graphicSelection,{})}initGraphic(e){this.params={...this.params,...e,graphicRowBarLayout:{...this.params.graphicRowBarLayout,...e.graphicRowBarLayout}},this.bar.setParams({...this.params.graphicRowBarLayout,colors:this.params.colors,highlightTarget:this.params.highlightTarget,highlightDatumId:this.params.highlightDatumId,highlightItemId:this.params.highlightItemId,highlightGroupId:this.params.highlightGroupId}),this.bar.on("click",n=>{const i=this.makeActivedCallbackData(n.itemLabel??"",_);this.clickCallback(i)}).on("mouseover",n=>{const i=this.makeActivedCallbackData(n.itemLabel??"",_);this.showTooltip(i,_),this.mouseoverCallback(i)}).on("mousemove",n=>{const i=this.makeActivedCallbackData(n.itemLabel??"",_);this.showTooltip(i,_),this.mousemoveCallback(i)}).on("mouseout",n=>{const i=this.makeActivedCallbackData("",_);this.showTooltip(void 0,_),this.mouseoutCallback(i)})}makeGraphicRenderData({dataset:e,xScale:n,yScale:i}){return e.data.map((r,a)=>{const s=e.itemLabels&&e.itemLabels[a]?e.itemLabels[a]:Ni;return r.map((o,l)=>{const h=e.yLabels[l],f=i(h)||0;return{...o,id:`${s}_${h}`,itemIndex:a,itemLabel:s,yIndex:l,yLabel:h,x:n(o.value)||0,y:f}})})}getMinAndMaxValue(e){if(!e.length)return[0,0];const n=(a,s,o)=>{let l=[];for(let h=0;h<a[0].length;h++){l[h]=0;for(let f=s;f<=o;f++)l[h]+=a[f][h].value}return l};let i=0,r=[];return this.params.graphicRowBarLayout.groupLayout.length?this.params.graphicRowBarLayout.groupLayout.forEach(a=>{const s=i+a.stackAmount-1;r=r.concat(n(e,i,s)),i=s+1}):r=n(e,0,e[0].length-1),r.reduce((a,s)=>[s<a[0]?s:a[0],s>a[1]?s:a[1]],[1/0,0])}makeYDataMap({renderData:e,yLabels:n}){let i=new Map;return e.length&&e.forEach((r,a)=>{r.forEach((s,o)=>{const l=i.get(n[o])??[];l.push(s),i.set(n[o],l)})}),i}makeItemDataMap({renderData:e,itemLabels:n}){let i=new Map;return e.length&&n.forEach((r,a)=>{i.set(r,e[a])}),i}setGraphicData({renderData:e,itemLabels:n,yLabels:i,xScale:r,yScale:a}){this.bar.setDataset({data:e,yLabels:i,itemLabels:n??[Ni],axisHeight:this.axisHeight,zeroX:0})}renderGraphic(){this.bar.render()}renderGraphicCoverHighlight({eventData:e,xScale:n,yScale:i,padding:r}){}}const Iu={xLabel:"x",yLabel:"y",xLabelAnchor:"start",yLabelAnchor:"end",xLabelOffset:[0,0],yLabelOffset:[0,0],xTickPadding:20,yTickPadding:20,xTickLine:!1,yTickLine:!0,xTickLineDasharray:"none",yTickLineDasharray:"none",yTickFormat:",.0f",yTicks:4,axisLineColor:On,axisLabelColor:ht,rotateXLabel:!1,padding:nt,xVisible:!0,yVisible:!0},Pu={barWidth:0,barGroupPadding:20,barR:!1,colors:P,highlightTarget:"item",highlightGroupId:"",highlightItemId:"",highlightDatumId:"",enterDuration:800},Nu={lineCurve:"curveLinear",colors:P,highlightTarget:"item",highlightItemId:"",enterDuration:800},It={axisColumn:Iu,tooltipAside:{templateHtml:t=>t.groupData&&t.groupData[0]?`
          <div>
            <div>${t.groupData[0].xLabel}</div>
            <div>${t.groupData.map(e=>e.value).join(",")}</div>          
          </div>
        `:""},colors:P,padding:nt,highlightTarget:"datum",highlightDatumId:"",highlightItemId:"",showAuxLine:!1,domainMinValue:0,domainMaxValue:void 0,domainMinRange:void 0,domainMaxRange:.95},oc={...It,highlightTarget:"item",graphicColumnLine:jt,graphicDot:Rt,showDot:"hover"};({...It});({...It});({...It});({...It});({...It});const lc={__name:"ChartRowBarLayout",setup(t){const e={data:[[{value:70769},{value:14103},{value:41075},{value:55309}],[{value:685830},{value:102725},{value:339702},{value:610896}],[{value:875854},{value:144274},{value:786471},{value:1097621}],[{value:1632453},{value:261102},{value:1167248},{value:1763826}],[{value:21381},{value:3423},{value:12341},{value:17006}],[{value:1653834},{value:264525},{value:1179589},{value:1780832}]],yLabels:["台北市","新竹市","台南市","高雄市"],itemLabels:["宋楚瑜、余湘","韓國瑜、張善政","蔡英文、賴清德","有效票數","無效票數","投票數"]},n={colors:["#FF6310","#000095","#1B9431","#8F4586","#5A5AAD","#709EE2"],padding:{top:50,right:70,bottom:50,left:100},axisRow:{yLabel:"",xLabel:""},graphicRowBarLayout:{groupLayout:[{stackAmount:3,barWidth:24},{stackAmount:2,barwidth:6,barR:10},{stackAmount:1,barwidth:12,barR:10}],barPadding:5,barGroupPadding:30,labelTextMethod:(i,r)=>String(i.value),labelPositionMethod:(i,r)=>r[0]===5?"right":"center",labelStyleMethod:(i,r)=>r[0]===5?"font-weight:800;font-size:18px;fill:#709EE2":"",labelFontSizeMethod:(i,r)=>10,labelColorMethod:(i,r)=>"#ffffff",labelPadding:5}};return(i,r)=>(pe(),me("div",null,[Ht(Er,{module:Ei(Tu),dataset:e,params:n},null,8,["module"])]))}},Eu={types:[],colors:P,highlightId:void 0,groupMode:"center",padding:nt,tooltipFollowing:{templateHtml:t=>`
      <div>${t.label}</div>
      <div>${t.value}</div>
    `,insideBoxMode:!0,type:"black"},force:{strength:.03,velocityDecay:.2,collisionSpacing:2}};let Yu=class{constructor(e,n){this.params=Eu,this.data=[],this.width=Pe,this.height=Ne,this.sourceData=[],this.graphicWidth=Pe,this.graphicHeight=Ne,this.bubbleGroupR=350,this.groupMode="center",this.maxValue=0,this.totalValue=0,this.avgValue=0,this.highlightId="",this.tooltip=void 0,this.mouseoverCallback=function(){},this.mousemoveCallback=function(){},this.mouseoutCallback=function(){},this.clickCallback=function(){},this.selection=e,this.graphicSelection=this.selection.append("g"),this.tooltip=new eu(this.selection)}resize({width:e,height:n}){this.width=e,this.height=n,this.graphicWidth=Kt(this.width,this.params.padding),this.graphicHeight=Zt(this.height,this.params.padding),this.selection.attr("width",e).attr("height",n),this.graphicSelection.attr("width",this.graphicWidth).attr("height",this.graphicHeight);const i=Math.min(this.graphicWidth,this.graphicHeight);this.bubbleGroupR=i/2}setData(e){if(this.sourceData=JSON.parse(JSON.stringify(e)),!this.data.length)this.data=this.sourceData.map((n,i)=>({...n,x:Math.random()*this.graphicWidth,y:Math.random()*this.graphicHeight,r:0}));else{const n=new Map(this.data.map(i=>[i.id,i]));this.data=this.sourceData.map((i,r)=>{const a=n.get(i.id);return a?(a.x,a.y,{...a,value:i.value,label:i.label,type:i.type,r:0}):{...i,x:Math.random()*this.graphicWidth,y:Math.random()*this.graphicHeight,r:0}})}this.data=this.data.sort((n,i)=>i.value-n.value),this.maxValue=Math.max(...this.sourceData.map(n=>n.value)),this.totalValue=this.sourceData.map(n=>n.value).reduce((n,i)=>n+i,0),this.avgValue=this.totalValue/this.sourceData.length}render(){this.calcBubbleR(this.data,this.bubbleGroupR);let e=this.graphicSelection.selectAll("g").data(this.data,i=>i.id),n=e.enter().append("g").attr("cursor","pointer");n.style("font-size",12).style("fill","#ffffff").attr("text-anchor","middle").attr("transform",i=>`translate(${i.x},${i.y})`),n.append("circle").attr("class","node").attr("cx",0).attr("cy",0).attr("fill",i=>this.scaleFillColor(i.type)),n.append("text").style("opacity",.8),e.exit().remove(),this.bubblesSelection=e.merge(n),this.bubblesSelection.select("circle").transition().duration(200).attr("r",i=>i.r).attr("fill",i=>this.scaleFillColor(i.type)),this.bubblesSelection.each((i,r,a)=>{const s=I(a[r]);let o=!0;i.label.length<5&&(o=!1),jh(s,{text:i.label,radius:i.r*.6,lineHeight:12,isBreakAll:o})}),this.setBubbleMouseEvent(this.bubblesSelection),this.force.nodes(this.data),this.groupMode=="type"?this.splitBubbles():this.groupMode=="rank"?this.rankBubbles():this.groupBubbles()}remove(){this.selection.remove()}select(){return this.selection}setParams(e){this.params={...this.params,...e,force:{...this.params.force,...e.force},tooltipFollowing:{...this.params.tooltipFollowing,...e.tooltipFollowing}},e.highlightId!=null&&this.setHighlight(e.highlightId),e.groupMode!=null&&(this.params.groupMode=e.groupMode,this.groupMode=e.groupMode),e.tooltipFollowing&&this.tooltip.setParams({templateHtml:this.params.tooltipFollowing.templateHtml,insideBoxMode:this.params.tooltipFollowing.insideBoxMode??!0,type:this.params.tooltipFollowing.type??"black"}),this.graphicSelection.attr("transform",`translate(${this.params.padding.left}, ${this.params.padding.top})`),this.scaleFillColor=Ge().domain(this.params.types).range(this.params.colors),this.force=this.makeForce(this.params),this.force.stop()}on(e,n){return e==="click"?this.clickCallback=n:e==="mouseover"?this.mouseoverCallback=n:e==="mousemove"?this.mousemoveCallback=n:e==="mouseout"&&(this.mouseoutCallback=n),this}makeForce(e){return Ul().velocityDecay(e.force.velocityDecay).force("collision",Xl().radius(n=>n.r+e.force.collisionSpacing)).force("charge",Wl().strength(n=>-Math.pow(n.r,2)*e.force.strength)).on("tick",()=>{this.bubblesSelection&&this.bubblesSelection.attr("transform",n=>`translate(${n.x},${n.y})`)})}calcBubbleR(e,n){const i=()=>{const r=n/Math.sqrt(this.data.length),s=r*r*Math.PI/this.avgValue,o=this.maxValue*s;return Math.pow(o/Math.PI,.5)*.75};this.scaleBubbleR=Fn().domain([0,this.maxValue]).range([0,i()]).exponent(.5),e.forEach(r=>{const a=this.scaleBubbleR(r.value);r.r=this.highlightId==r.id?a+10:a})}setBubbleMouseEvent(e){e.on("mouseover",(n,i,r)=>{this.tooltip.setDatum({data:n,x:_.clientX,y:_.clientY}),this.setHighlight(n.id),this.mouseoverCallback(n)}).on("mousemove",(n,i,r)=>{this.tooltip.setDatum({x:_.clientX,y:_.clientY}),this.mousemoveCallback(n)}).on("mouseout",(n,i,r)=>{this.tooltip.remove(),this.setHighlight(""),this.mouseoutCallback(n)}).on("click",(n,i,r)=>{this.clickCallback(n)}).call(this.drag())}drag(){return Hs().on("start",e=>{_.active||this.force.alpha(1).restart(),e.fx=e.x,e.fy=e.y}).on("drag",e=>{_.active||this.force.alphaTarget(0),e.fx=_.x,e.fy=_.y}).on("end",e=>{e.fx=null,e.fy=null})}splitBubbles(){const e=this.graphicWidth/(this.params.types.length+1),n=new Map(this.params.types.map((i,r)=>[i,{x:e*(r+1),y:this.graphicHeight/2}]));this.force.force("x",on().strength(this.params.force.strength).x(i=>n.get(i.type).x)).force("y",ln().strength(this.params.force.strength).y(this.graphicHeight/2)),this.force.alpha(3).restart()}groupBubbles(){this.force.force("x",on().strength(this.params.force.strength).x(this.graphicWidth/2)).force("y",ln().strength(this.params.force.strength).y(this.graphicHeight/2)),this.force.alpha(1).restart()}rankBubbles(){if(!this.data.length)return;const e=100,n=10,i=this.graphicWidth-e*2;let r=e,a=e+this.data[0].r,s=0,o=this.data[0].r,l=this.data.map((h,f)=>{let c=r+s+n+h.r,u=a;return c>i&&(c=e+h.r,u+=o+n+h.r,o=h.r),r=c,a=u,s=h.r,{x:c,y:u}});this.force.force("x",on().strength(this.params.force.strength).x((h,f)=>l[f].x)).force("y",ln().strength(this.params.force.strength).y((h,f)=>l[f].y)),this.force.alpha(3).restart()}setHighlight(e){this.params.highlightId=e,this.highlightId=e,this.highlightId==""?this.bubblesSelection.style("opacity",1):this.bubblesSelection.style("opacity",n=>n.id==this.highlightId?1:.5)}};const Bu={class:"type-btns"},Hu={__name:"ChartBubbleGroup",props:["groupMode"],setup(t){const e=t,n=[{id:"台北市_選舉人數",label:"台北市",value:2167264,type:"選舉人數"},{id:"新竹市_選舉人數",label:"新竹市",value:345345,type:"選舉人數"},{id:"台南市_選舉人數",label:"台南市",value:1556845,type:"選舉人數"},{id:"高雄市_選舉人數",label:"高雄市",value:2299558,type:"選舉人數"},{id:"台北市_投票數",label:"台北市",value:1653834,type:"投票數"},{id:"新竹市_投票數",label:"新竹市",value:264525,type:"投票數"},{id:"台南市_投票數",label:"台南市",value:1179589,type:"投票數"},{id:"高雄市_投票數",label:"高雄市",value:1780832,type:"投票數"},{id:"台北市_有效票數",label:"台北市",value:1632453,type:"有效票數"},{id:"新竹市_有效票數",label:"新竹市",value:261102,type:"有效票數"},{id:"台南市_有效票數",label:"台南市",value:1167248,type:"有效票數"},{id:"高雄市_有效票數",label:"高雄市",value:1763826,type:"有效票數"},{id:"台北市_無效票數",label:"台北市",value:21381,type:"無效票數"},{id:"新竹市_無效票數",label:"新竹市",value:3423,type:"無效票數"},{id:"台南市_無效票數",label:"台南市",value:12341,type:"無效票數"},{id:"高雄市_無效票數",label:"高雄市",value:17006,type:"無效票數"},{id:"台北市_未投票數",label:"台北市",value:143,type:"未投票數"},{id:"新竹市_未投票數",label:"新竹市",value:8,type:"未投票數"},{id:"台南市_未投票數",label:"台南市",value:22,type:"未投票數"},{id:"高雄市_未投票數",label:"高雄市",value:12,type:"未投票數"}],i=at({colors:["#4A4AFF","#0080FF","#00E3E3","#02F78E","#00EC00"],types:["選舉人數","投票數","有效票數","無效票數","未投票數"],collisionSpacing:2,groupMode:"center",tooltipFollowing:{templateHtml:s=>`${s.label}<br/>選舉人數：${s.value}`}}),r=at("center"),a=s=>{r.value=s};return K(()=>e.groupMode,s=>{i.value.groupMode=s}),(s,o)=>{const l=Kn("el-button"),h=Kn("el-row");return pe(),me("div",null,[qr("div",Bu,[Ht(h,null,{default:je(()=>[Ht(l,{onClick:o[0]||(o[0]=f=>a("center")),class:Zn([r.value==="center"?"checked":""])},{default:je(()=>[Qn("預設")]),_:1},8,["class"]),Ht(l,{onClick:o[1]||(o[1]=f=>a("type")),class:Zn([r.value==="type"?"checked":""])},{default:je(()=>[Qn("分類")]),_:1},8,["class"])]),_:1})]),Ht(Er,{module:Ei(Yu),data:n,params:i.value},null,8,["module","params"])])}}},uc=Nr(Hu,[["__scopeId","data-v-3b093167"]]);export{ph as $,ni as A,Rs as B,uc as C,Is as D,Ps as E,Ts as F,vr as G,Wt as H,q as I,mt as J,sh as K,lh as L,zn as M,Dr as N,Lr as O,Jt as P,Jr as Q,U as R,W as S,Ae as T,Xn as U,Ce as V,ch as W,tt as X,Kr as Y,ec as Z,lc as _,Yi as a,Ge as a$,Ou as a0,xe as a1,lt as a2,yh as a3,Vt as a4,G as a5,Ri as a6,T as a7,Fh as a8,xt as a9,Zs as aA,js as aB,Z as aC,sr as aD,to as aE,be as aF,Uu as aG,io as aH,hr as aI,so as aJ,oo as aK,zi as aL,He as aM,ti as aN,eh as aO,nh as aP,ih as aQ,Bn as aR,ju as aS,tc as aT,ah as aU,Ju as aV,rh as aW,Qu as aX,Ar as aY,wi as aZ,Oe as a_,$n as aa,kh as ab,sa as ac,oa as ad,Fu as ae,zu as af,Xu as ag,dt as ah,Hs as ai,ml as aj,Vu as ak,qu as al,yl as am,Ku as an,Zu as ao,Xl as ap,Wl as aq,Ul as ar,on as as,ln as at,th as au,jl as av,_r as aw,Se as ax,Wu as ay,Ks as az,Hi as b,kr as b0,Fn as b1,Sr as b2,nc as b3,St as b4,Sn as b5,Xi as b6,_l as b7,Mt as b8,fh as b9,$r as bA,We as bB,uu as bC,hu as bD,iu as bE,ru as bF,au as bG,ac as bH,Du as bI,Ru as bJ,sc as bK,Iu as bL,It as bM,oc as bN,Nr as bO,he as ba,di as bb,In as bc,ho as bd,pl as be,Gi as bf,Gh as bg,nu as bh,Pe as bi,Ne as bj,su as bk,ic as bl,ou as bm,lu as bn,eu as bo,rc as bp,Er as bq,cu as br,Kt as bs,Zt as bt,tu as bu,nt as bv,jt as bw,gu as bx,P as by,Rt as bz,I as c,$i as d,Ji as e,Vs as f,Rn as g,tr as h,Qt as i,ve as j,Gt as k,Gu as l,qs as m,rr as n,ze as o,ji as p,Me as q,Qi as r,Qr as s,jr as t,gi as u,st as v,_ as w,Be as x,Tn as y,mo as z};
